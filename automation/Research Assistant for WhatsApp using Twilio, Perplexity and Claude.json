{
  "id": 6926,
  "name": "Research Assistant for WhatsApp using Twilio, Perplexity and Claude",
  "totalViews": 189,
  "purchaseUrl": null,
  "user": {
    "name": "Harsh Maniya",
    "username": "harshmaniya1",
    "bio": "Crafting Intelligent AI Solutions | AI Engineer building the next generation of intelligent workflows on n8n. Automating the complex, one node at a time.",
    "verified": true,
    "links": [
      "https://x.com/HarshhManiya"
    ],
    "avatar": "https://gravatar.com/avatar/ae32ae0741752e90c2e3e94aa16a68b89b48c24b685b86dbb54ade7ed21218d7?r=pg&d=retro&size=200"
  },
  "description": "## Build an AI Research Assistant for WhatsApp with Perplexity and Claude üí°\n\nEver wished you could get a deep, multi-source research report on any topic, delivered directly to your WhatsApp chat in seconds? This workflow transforms your WhatsApp into a powerful, on-demand research assistant, perfect for students, professionals, and curious minds.\n\nLeveraging the deep research capabilities of **Perplexity**, the nuanced formatting skills of **Anthropic's Claude**, and the messaging power of **Twilio**, this workflow automates the entire process from query to polished answer. Ask it anything, and receive a well-structured, easy-to-read summary moments later.\n\n### What This Workflow Does üöÄ\n\n  * üì≤ **Listens for Incoming Queries**: The workflow starts when a user sends a message to your configured Twilio WhatsApp number.\n  * üß† **Performs Deep Research**: It takes the user's query and feeds it to the **Perplexity** node, which uses the `sonar-pro` model to conduct a comprehensive, multi-source analysis on the topic.\n  * üé® **Polishes the Content**: The raw, detailed research report from Perplexity is then passed to an **Anthropic Claude** model. This crucial step refines the text, adds engaging emojis, ensures it's under the WhatsApp character limit, and formats it perfectly for mobile viewing.\n  * üí¨ **Sends an Instant Reply**: The final, beautifully formatted summary is sent directly back to the user's WhatsApp chat via **Twilio**, completing the entire request.\n\n### Nodes Used üõ†Ô∏è\n\n  * **Webhook**: To receive the initial message from Twilio and trigger the workflow.\n  * **Perplexity**: To perform the AI-powered deep research on the user's query.\n  * **Anthropic (via LangChain)**: To connect to and use the Claude model for reformatting and polishing the content.\n  * **Twilio**: To send the final, formatted message back to the user on WhatsApp.\n\n### How to Set Up This Workflow ‚öôÔ∏è\n\nThis workflow requires careful setup between n8n and Twilio to function correctly. Follow these steps closely.\n\n#### 1\\. Prerequisites ‚úÖ\n\nYou will need accounts for the following services:\n\n  * [n8n](https://n8n.io/) (Cloud or self-hosted)\n  * [Twilio](https://www.twilio.com/try-twilio)\n  * [Perplexity AI](https://docs.perplexity.ai/) (for an API key)\n  * [Anthropic](https://console.anthropic.com/) (for a Claude API key)\n\n#### 2\\. Configure Credentials üîë\n\nIn your n8n instance, add your API keys for **Twilio**, **Perplexity**, and **Anthropic**.\n\n  - You can add credentials in n8n by going to the **Credentials** tab in the left-hand menu.\n  - [Learn more about managing credentials in n8n](https://docs.n8n.io/credentials/).\n\n#### 3\\. Set Up Your Twilio WhatsApp Number üì±\n\n1.  Log in to your Twilio account.\n2.  Either purchase a phone number that is WhatsApp-enabled or use the free **Twilio Sandbox for WhatsApp** for testing.\n3.  Follow Twilio's guide to connect your number or sandbox to the WhatsApp Business API.\n      - [Read Twilio's Getting Started with WhatsApp Guide](https://www.twilio.com/docs/whatsapp/sandbox).\n\n#### 4\\. Expose Your n8n Webhook URL üåê\n\nFor Twilio to communicate with n8n, your n8n webhook URL must be publicly accessible.\n\n1.  Open the **Fetch Whatsapp Request** (Webhook) node in the workflow.\n2.  You will see two URLs: **Test** and **Production**. For this guide, we will use the **Test URL**.\n3.  **If you are running n8n locally or on a private server**, you must expose this URL to the public internet. You can do this easily using n8n's built-in tunnel feature.\n      - Start n8n from your computer's command line with the following command:\n        ```bash\n        n8n start --tunnel\n        ```\n      - After starting, n8n will provide you with a public \"tunnel URL\". It will look something like `https://[subdomain].hooks.n8n.cloud/`.\n      - **Copy this public tunnel URL.**\n      - [Learn more about tunneling in the n8n docs](https://docs.n8n.io/hosting/installation/npm/#n8n-with-tunnel).\n\n#### 5\\. Connect Twilio to Your n8n Webhook üîó\n\n1.  In your [Twilio Console](https://console.twilio.com/), navigate to the settings for the phone number (or sandbox) you configured in Step 3.\n2.  Scroll down to the **Messaging** section.\n3.  Find the field labeled **\"A MESSAGE COMES IN\"**.\n4.  Paste your **n8n Test URL** (or your public tunnel URL from the previous step) into this field.\n5.  Ensure the dropdown next to it is set to `HTTP POST`.\n6.  Click **Save**.\n\n#### 6\\. Activate and Test Your Workflow ‚ñ∂Ô∏è\n\n1.  Go back to your n8n canvas.\n2.  Click **\"Test workflow\"** in the top right corner. This will put your webhook in a \"listening\" state.\n3.  Now, send a message from your personal WhatsApp to your configured Twilio WhatsApp number.\n4.  You should see the workflow execute successfully in n8n and receive a formatted reply on WhatsApp\\!\n5.  Once you've confirmed it works, **save and activate** the workflow to have it run permanently.\n\n## Further Reading üìö\n\n  * [n8n Webhook Node Documentation](https://docs.n8n.io/nodes/n8n-nodes-base.webhook/)\n  * [n8n Twilio Node Documentation](https://docs.n8n.io/nodes/n8n-nodes-base.twilio/)\n  * [Perplexity API Documentation](https://docs.perplexity.ai/)\n  * [Anthropic API Documentation](https://docs.anthropic.com/en/api/getting-started)",
  "createdAt": "2025-08-03T07:00:17.460Z",
  "nodes": [
    {
      "id": 45,
      "icon": "file:twilio.svg",
      "name": "n8n-nodes-base.twilio",
      "codex": {
        "data": {
          "alias": [
            "SMS",
            "Phone",
            "Voice"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/love-at-first-sight-ricardos-n8n-journey/",
                "icon": "‚ù§Ô∏è",
                "label": "Love at first sight: Ricardo‚Äôs n8n journey"
              },
              {
                "url": "https://n8n.io/blog/database-monitoring-and-alerting-with-n8n/",
                "icon": "üì°",
                "label": "Database Monitoring and Alerting with n8n"
              },
              {
                "url": "https://n8n.io/blog/automatically-adding-expense-receipts-to-google-sheets-with-telegram-mindee-twilio-and-n8n/",
                "icon": "üßæ",
                "label": "Automatically Adding Expense Receipts to Google Sheets with Telegram, Mindee, Twilio, and n8n"
              },
              {
                "url": "https://n8n.io/blog/tracking-time-spent-in-meetings-with-google-calendar-twilio-and-n8n/",
                "icon": "üóì",
                "label": "Tracking Time Spent in Meetings With Google Calendar, Twilio, and n8n"
              },
              {
                "url": "https://n8n.io/blog/creating-error-workflows-in-n8n/",
                "icon": "üå™",
                "label": "Creating Error Workflows in n8n"
              },
              {
                "url": "https://n8n.io/blog/sending-automated-congratulations-with-google-sheets-twilio-and-n8n/",
                "icon": "üôå",
                "label": "Sending Automated Congratulations with Google Sheets, Twilio, and n8n "
              },
              {
                "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                "icon": "üß∞",
                "label": "Learn to Build Powerful API Endpoints Using Webhooks"
              },
              {
                "url": "https://n8n.io/blog/sending-sms-the-low-code-way-with-airtable-twilio-programmable-sms-and-n8n/",
                "icon": "üì±",
                "label": "Sending SMS the Low-Code Way with Airtable, Twilio Programmable SMS, and n8n"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.twilio/"
              }
            ],
            "credentialDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/credentials/twilio/"
              }
            ]
          },
          "categories": [
            "Communication",
            "Development"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0"
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Twilio"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiB2aWV3Qm94PSIwIDAgNjUgNjUiPjx1c2UgeGxpbms6aHJlZj0iI2EiIHg9Ii41IiB5PSIuNSIvPjxzeW1ib2wgaWQ9ImEiIG92ZXJmbG93PSJ2aXNpYmxlIj48ZyBmaWxsPSIjZTMxZTI2IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZT0ibm9uZSI+PHBhdGggZD0iTTMxLjk1MyAwQzE0LjMzNyAwIDAgMTQuMzM3IDAgMzEuOTUzczE0LjMzNyAzMS45NTMgMzEuOTUzIDMxLjk1M0M0OS42NjMgNjQgNjQgNDkuNjYzIDY0IDMxLjk1M1M0OS42NjMgMCAzMS45NTMgMG0wIDU1LjU2N2MtMTIuOTMxIDAtMjMuNTItMTAuNTg5LTIzLjUyLTIzLjYxNCAwLTEyLjkzMSAxMC41ODktMjMuNTIgMjMuNTItMjMuNTIgMTMuMDI1IDAgMjMuNjE0IDEwLjU4OSAyMy42MTQgMjMuNTIgMCAxMy4wMjUtMTAuNTg5IDIzLjYxNC0yMy42MTQgMjMuNjE0Ii8+PHVzZSB4bGluazpocmVmPSIjYiIvPjx1c2UgeGxpbms6aHJlZj0iI2IiIHk9IjE1LjkzIi8+PHBhdGggZD0iTTE3LjMzNSAzOS45MThhNi42NCA2LjY0IDAgMCAxIDYuNjUzLTYuNjUzIDYuNjUzIDYuNjUzIDAgMSAxIDAgMTMuMzA2IDYuNjQgNi42NCAwIDAgMS02LjY1My02LjY1M20wLTE1LjkzYTYuNjQgNi42NCAwIDAgMSA2LjY1My02LjY1MyA2LjY0IDYuNjQgMCAwIDEgNi42NTMgNi42NTMgNi42NCA2LjY0IDAgMCAxLTYuNjUzIDYuNjUzIDYuNjQgNi42NCAwIDAgMS02LjY1My02LjY1MyIvPjwvZz48L3N5bWJvbD48ZGVmcz48cGF0aCBpZD0iYiIgZD0iTTMzLjI2NSAyMy45ODhhNi42NCA2LjY0IDAgMSAxIDEzLjMwNiAwIDYuNjQgNi42NCAwIDEgMS0xMy4zMDYgMCIvPjwvZGVmcz48L3N2Zz4="
      },
      "displayName": "Twilio",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 5,
          "name": "Development"
        },
        {
          "id": 6,
          "name": "Communication"
        }
      ]
    },
    {
      "id": 47,
      "icon": "file:webhook.svg",
      "name": "n8n-nodes-base.webhook",
      "codex": {
        "data": {
          "alias": [
            "HTTP",
            "API",
            "Build",
            "WH"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/learn-how-to-automatically-cross-post-your-content-with-n8n/",
                "icon": "‚úçÔ∏è",
                "label": "Learn how to automatically cross-post your content with n8n"
              },
              {
                "url": "https://n8n.io/blog/running-n8n-on-ships-an-interview-with-maranics/",
                "icon": "üõ≥",
                "label": "Running n8n on ships: An interview with Maranics"
              },
              {
                "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                "icon": "üîó",
                "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
              },
              {
                "url": "https://n8n.io/blog/what-are-apis-how-to-use-them-with-no-code/",
                "icon": " ü™¢",
                "label": "What are APIs and how to use them with no code"
              },
              {
                "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                "icon": "‚ö°Ô∏è",
                "label": "5 tasks you can automate with the new Notion API "
              },
              {
                "url": "https://n8n.io/blog/how-a-digital-strategist-uses-n8n-for-online-marketing/",
                "icon": "üíª",
                "label": "How a digital strategist uses n8n for online marketing"
              },
              {
                "url": "https://n8n.io/blog/the-ultimate-guide-to-automate-your-video-collaboration-with-whereby-mattermost-and-n8n/",
                "icon": "üìπ",
                "label": "The ultimate guide to automate your video collaboration with Whereby, Mattermost, and n8n"
              },
              {
                "url": "https://n8n.io/blog/how-to-automatically-give-kudos-to-contributors-with-github-slack-and-n8n/",
                "icon": "üëè",
                "label": "How to automatically give kudos to contributors with GitHub, Slack, and n8n"
              },
              {
                "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                "icon": "ü§ñ",
                "label": "5 workflow automations for Mattermost that we love at n8n"
              },
              {
                "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                "icon": "üß†",
                "label": "Why this Product Manager loves workflow automation with n8n"
              },
              {
                "url": "https://n8n.io/blog/creating-custom-incident-response-workflows-with-n8n/",
                "label": "How to automate every step of an incident response workflow"
              },
              {
                "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                "icon": "üß∞",
                "label": "Learn to Build Powerful API Endpoints Using Webhooks"
              },
              {
                "url": "https://n8n.io/blog/learn-how-to-use-webhooks-with-mattermost-slash-commands/",
                "icon": "ü¶Ñ",
                "label": "Learn how to use webhooks with Mattermost slash commands"
              },
              {
                "url": "https://n8n.io/blog/how-goomer-automated-their-operations-with-over-200-n8n-workflows/",
                "icon": "üõµ",
                "label": "How Goomer automated their operations with over 200 n8n workflows"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/"
              }
            ]
          },
          "categories": [
            "Development",
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"trigger\"]",
      "defaults": {
        "name": "Webhook"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCI+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTM1IDM3Yy0yLjIgMC00LTEuOC00LTRzMS44LTQgNC00IDQgMS44IDQgNC0xLjggNC00IDQiLz48cGF0aCBmaWxsPSIjMzc0NzRmIiBkPSJNMzUgNDNjLTMgMC01LjktMS40LTcuOC0zLjdsMy4xLTIuNWMxLjEgMS40IDIuOSAyLjMgNC43IDIuMyAzLjMgMCA2LTIuNyA2LTZzLTIuNy02LTYtNmMtMSAwLTIgLjMtMi45LjdsLTEuNyAxTDIzLjMgMTZsMy41LTEuOSA1LjMgOS40YzEtLjMgMi0uNSAzLS41IDUuNSAwIDEwIDQuNSAxMCAxMFM0MC41IDQzIDM1IDQzIi8+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTE0IDQzQzguNSA0MyA0IDM4LjUgNCAzM2MwLTQuNiAzLjEtOC41IDcuNS05LjdsMSAzLjlDOS45IDI3LjkgOCAzMC4zIDggMzNjMCAzLjMgMi43IDYgNiA2czYtMi43IDYtNnYtMmgxNXY0SDIzLjhjLS45IDQuNi01IDgtOS44IDgiLz48cGF0aCBmaWxsPSIjZTkxZTYzIiBkPSJNMTQgMzdjLTIuMiAwLTQtMS44LTQtNHMxLjgtNCA0LTQgNCAxLjggNCA0LTEuOCA0LTQgNCIvPjxwYXRoIGZpbGw9IiMzNzQ3NGYiIGQ9Ik0yNSAxOWMtMi4yIDAtNC0xLjgtNC00czEuOC00IDQtNCA0IDEuOCA0IDQtMS44IDQtNCA0Ii8+PHBhdGggZmlsbD0iI2U5MWU2MyIgZD0ibTE1LjcgMzQtMy40LTIgNS45LTkuN2MtMi0xLjktMy4yLTQuNS0zLjItNy4zIDAtNS41IDQuNS0xMCAxMC0xMHMxMCA0LjUgMTAgMTBjMCAuOS0uMSAxLjctLjMgMi41bC0zLjktMWMuMS0uNS4yLTEgLjItMS41IDAtMy4zLTIuNy02LTYtNnMtNiAyLjctNiA2YzAgMi4xIDEuMSA0IDIuOSA1LjFsMS43IDF6Ii8+PC9zdmc+"
      },
      "displayName": "Webhook",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 5,
          "name": "Development"
        },
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 565,
      "icon": "fa:sticky-note",
      "name": "n8n-nodes-base.stickyNote",
      "codex": {
        "data": {
          "alias": [
            "Comments",
            "Notes",
            "Sticky"
          ],
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"input\"]",
      "defaults": {
        "name": "Sticky Note",
        "color": "#FFD233"
      },
      "iconData": {
        "icon": "sticky-note",
        "type": "icon"
      },
      "displayName": "Sticky Note",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 1123,
      "icon": "fa:link",
      "name": "@n8n/n8n-nodes-langchain.chainLlm",
      "codex": {
        "data": {
          "alias": [
            "LangChain"
          ],
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm/"
              }
            ]
          },
          "categories": [
            "AI",
            "Langchain"
          ],
          "subcategories": {
            "AI": [
              "Chains",
              "Root Nodes"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Basic LLM Chain",
        "color": "#909298"
      },
      "iconData": {
        "icon": "link",
        "type": "icon"
      },
      "displayName": "Basic LLM Chain",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 25,
          "name": "AI"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    },
    {
      "id": 1145,
      "icon": "file:anthropic.svg",
      "name": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "codex": {
        "data": {
          "alias": [
            "claude",
            "sonnet",
            "opus"
          ],
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatanthropic/"
              }
            ]
          },
          "categories": [
            "AI",
            "Langchain"
          ],
          "subcategories": {
            "AI": [
              "Language Models",
              "Root Nodes"
            ],
            "Language Models": [
              "Chat Models (Recommended)"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Anthropic Chat Model"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzdEN0Q4NyIgZD0iTTMyLjczIDBoLTYuOTQ1TDM4LjQ1IDMyaDYuOTQ1ek0xMi42NjUgMCAwIDMyaDcuMDgybDIuNTktNi43MmgxMy4yNWwyLjU5IDYuNzJoNy4wODJMMTkuOTI5IDB6bS0uNzAyIDE5LjMzNyA0LjMzNC0xMS4yNDYgNC4zMzQgMTEuMjQ2eiIvPjwvc3ZnPg=="
      },
      "displayName": "Anthropic Chat Model",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 25,
          "name": "AI"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    },
    {
      "id": 1304,
      "icon": "file:perplexity.svg",
      "name": "n8n-nodes-base.perplexity",
      "codex": {
        "data": {
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-langchain.perplexity/"
              }
            ],
            "credentialDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/credentials/perplexity/"
              }
            ]
          },
          "categories": [
            "Utility"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0"
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Perplexity"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iMjcwLjAwMDAwMHB0IiBoZWlnaHQ9IjI3MC4wMDAwMDBwdCIgdmlld0JveD0iMCAwIDI3MC4wMDAwMDAgMjcwLjAwMDAwMCIKIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiPgo8bWV0YWRhdGE+CkNyZWF0ZWQgYnkgcG90cmFjZSAxLjE0LCB3cml0dGVuIGJ5IFBldGVyIFNlbGluZ2VyIDIwMDEtMjAxNwo8L21ldGFkYXRhPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwyNzAuMDAwMDAwKSBzY2FsZSgwLjEwMDAwMCwtMC4xMDAwMDApIgpmaWxsPSIjMDAwMDAwIiBzdHJva2U9Im5vbmUiPgo8cGF0aCBkPSJNMTg1IDI2OTEgYy04NiAtMjEgLTE1OCAtOTMgLTE3NSAtMTc1IC03IC0zNSAtMTAgLTQxNSAtOCAtMTE5NiAzCi0xMjc2IC0yIC0xMTgwIDczIC0xMjUzIDIwIC0yMCA1NCAtNDIgNzQgLTQ5IDUzIC0xOSAyMzQ5IC0xOSAyNDAyIDAgMjAgNyA1NAoyOSA3NCA0OSA3NSA3MyA3MCAtMjMgNzMgMTI1MyAyIDgxNyAtMSAxMTYxIC05IDEyMDAgLTkgNDYgLTE5IDYzIC02NCAxMDYKLTQyIDQxIC02MyA1NCAtMTA0IDYzIC01OSAxMyAtMjI4NCAxNCAtMjMzNiAyeiBtNzg2IC01NDcgbDMxNCAtMjU1IDMgMjU1IDIKMjU2IDYwIDAgNjAgMCAyIC0yNTUgMyAtMjU2IDMxNSAyNTcgMzE1IDI1NyAzIC0yOTIgMiAtMjkxIDEzNSAwIDEzNSAwIDAKLTQ1MCAwIC00NTAgLTEzNSAwIC0xMzUgMCAtMiAtMjk2IC0zIC0yOTUgLTMxMiAyNzUgYy0xNzIgMTUyIC0zMTUgMjc2IC0zMTgKMjc2IC0zIDAgLTUgLTEzMyAtNSAtMjk1IGwwIC0yOTUgLTYwIDAgLTYwIDAgMCAyOTUgYzAgMTYyIC0yIDI5NSAtNSAyOTUgLTMKMCAtMTQ2IC0xMjQgLTMxOCAtMjc2IGwtMzEyIC0yNzYgLTMgMjk2IC0yIDI5NiAtMTM1IDAgLTEzNSAwIDAgNDUwIDAgNDUwCjEzNSAwIDEzNSAwIDAgMjkwIGMwIDE2MCAyIDI5MCA0IDI5MCAyIDAgMTQ1IC0xMTUgMzE3IC0yNTZ6Ii8+CjxwYXRoIGQ9Ik03ODAgMTk4MSBsMCAtMTYxIDIxNSAwIDIxNiAwIC0yMDMgMTUxIGMtMTEyIDg0IC0yMDkgMTU2IC0yMTUgMTYyCi0xMCA3IC0xMyAtMjQgLTEzIC0xNTJ6Ii8+CjxwYXRoIGQ9Ik0xNzA2IDE5ODIgbC0yMTAgLTE1NyAyMDkgLTMgYzExNCAtMSAyMTAgLTEgMjEyIDEgMiAyIDIgNzQgMSAxNjAKbC0zIDE1NiAtMjA5IC0xNTd6Ii8+CjxwYXRoIGQ9Ik01MTAgMTM3MCBsMCAtMzMwIDcwIDAgNzAgMCAwIDg4IDAgODggMzggMzUgYzIwIDIwIDE0NiAxMjcgMjgwIDIzOQoxMzMgMTExIDI0MiAyMDQgMjQyIDIwNiAwIDIgLTE1NyA0IC0zNTAgNCBsLTM1MCAwIDAgLTMzMHoiLz4KPHBhdGggZD0iTTE0OTAgMTY5NiBjMCAtMiAxMjYgLTEwMiAyODAgLTIyMyBsMjgwIC0yMTggMCAtMTA3IDAgLTEwOCA3MCAwIDcwCjAgMCAzMzAgMCAzMzAgLTM1MCAwIGMtMTkyIDAgLTM1MCAtMiAtMzUwIC00eiIvPgo8cGF0aCBkPSJNMTAyOCAxMzkyIGwtMjQ3IC0yMTcgMCAtMjgzIGMtMSAtMjMzIDEgLTI4MiAxMiAtMjc1IDggNCAxMjIgMTA0CjI1NSAyMjIgbDI0MiAyMTQgMCAyNzggYzAgMTU0IC0zIDI3OSAtNyAyNzkgLTUgMCAtMTE5IC05OCAtMjU1IC0yMTh6Ii8+CjxwYXRoIGQ9Ik0xNDEwIDEzMzIgbDAgLTI3OSAyNDIgLTIxNCBjMTMzIC0xMTggMjQ3IC0yMTggMjU1IC0yMjIgMTEgLTcgMTMKNDIgMTIgMjc1IGwwIDI4MyAtMjQ1IDIxNSBjLTEzNSAxMTggLTI0OSAyMTcgLTI1NCAyMTggLTYgMiAtMTAgLTEwMSAtMTAKLTI3NnoiLz4KPC9nPgo8L3N2Zz4K"
      },
      "displayName": "Perplexity",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 7,
          "name": "Utility"
        }
      ]
    }
  ],
  "views": 189,
  "recentViews": 2,
  "workflow": {
    "id": "KxLD27K9btIxsRZo",
    "meta": {
      "instanceId": "e57d916222032d19fc69f0f34e059f722d4f608515cab84ee2db9eaaa4240714",
      "templateCredsSetupCompleted": true
    },
    "name": "Whatsapp Deep research",
    "tags": [],
    "nodes": [
      {
        "id": "f3a0dc1a-f64b-4f2e-945a-2cfdfe607e45",
        "name": "Fetch Whatsapp Request",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -528,
          0
        ],
        "webhookId": "51a2d8c0-138a-49fb-95a7-3eb342b46f4b",
        "parameters": {
          "path": "fetch-whatsapp-request",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 2
      },
      {
        "id": "51fc09d1-55e2-4198-977b-79066559d246",
        "name": "Perform Deep Research",
        "type": "n8n-nodes-base.perplexity",
        "position": [
          -224,
          0
        ],
        "parameters": {
          "model": "sonar-pro",
          "options": {},
          "messages": {
            "message": [
              {
                "content": "=You are a specialized AI Research Analyst. Your task is to perform a deep, comprehensive, and objective research analysis on the user-provided topic using your advanced sonar search capabilities. The final output must be a well-structured report formatted in Markdown, suitable for delivery via an API.\n\n**User Query:**\n\"{{ $json.body.Body }}\"\n\n**Required Output Structure:**\n\n1.  **Title:** A clear and concise title for the research report.\n2.  **Overview (1-2 paragraphs):** A high-level executive summary of the topic. This should give the user the most important information at a glance.\n3.  **Key Points (Bulleted List):** A list of 3-5 of the most critical facts, findings, or aspects of the topic.\n4.  **Detailed Analysis:** A more in-depth exploration of the topic. Break this section down with subheadings (using bold text) as needed. Cover background, current status, different perspectives, and relevant data.\n5.  **Conclusion:** A brief concluding paragraph that summarizes the main takeaways or future outlook.\n6.  **Sources:** A numbered list of the primary sources used for this analysis.\n\n**Guidelines:**\n-   **Tone:** Maintain a neutral, objective, and factual tone.\n-   **Accuracy:** Prioritize information from reputable sources. Synthesize findings from multiple sources to provide a balanced view.\n-   **Formatting:** Strictly adhere to the Markdown structure specified above. Use `*bold*` for headings and bullet points (`-` or `*`) for lists.\n-   **Clarity:** Write in clear, concise language. Avoid overly technical jargon where possible, or explain it if necessary.\n-   **Completeness:** The generated report should be a self-contained document based solely on the provided user query. Do not ask follow-up questions."
              }
            ]
          },
          "simplify": true,
          "requestOptions": {}
        },
        "credentials": {
          "perplexityApi": {
            "id": "6FACql65sGWXE02k",
            "name": "Perplexity account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "783daa3b-db9e-4a8c-b0e1-60679ee293cf",
        "name": "Refine Generated Output for Whatsapp",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          112,
          0
        ],
        "parameters": {
          "text": "=You are an expert content editor who transforms raw text into perfectly formatted summaries for WhatsApp. Your task is to take the provided research report and polish it into a message that is readable, engaging, and renders correctly on WhatsApp.\n\n**Raw Research Report:**\n{{ $json.message }}\n\n**Your Instructions:**\n\n1.  **Preserve Core Content:** Do not change the facts, data, or the meaning of the original text. Your job is to edit for style and formatting only.\n\n2.  **Add Emojis:**\n    * Add a single, relevant emoji at the beginning of the Title.\n    * Add relevant emojis to the main section headers and to each bullet point in the \"Key Points\" list.\n\n3.  **Strict Formatting Rules for WhatsApp:**\n    * **Bolding:** Apply bold formatting by enclosing headers in **single asterisks**. For example: `*Overview:*`. Do NOT use double asterisks.\n    * **Bullet Points:** Use a standard hyphen (`-`) followed by a single space for each bullet point.\n    * **Spacing:** Ensure there is a **double line break** (press Enter twice) between each major section to create clean visual separation.\n    * **Citations:** Preserve the numerical inline citations like `[1]`, `[2]`, etc., exactly as they are.\n\n4.  **Character Limit:** The entire final output MUST be less than 1600 characters to comply with WhatsApp's message limit. Be concise.\n\n5.  **No Preamble:** Your output must begin *directly* with the report's title. Do not include any introductory phrases like \"Here is the polished version:\".\n\n**Example of Desired Final Output Format:**\n\n*Example:*\nü§ñ *Title:* Example Report\nüìú *Overview:*\nThis is a summary of the topic. It is clear and concise.\n\nüéØ *Key Points:*\n- ‚úÖ This is the first key point.\n- ‚öôÔ∏è This is the second key point.\n\n---\n\nProduce the final, polished WhatsApp-ready report now, strictly following all the rules and the format shown in the example.\n\n**Remember whatsapp allows only 1600 characters to send via message so your output must be less than or equal to that.**",
          "batching": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "e613cdb5-7ba4-4519-b15e-a0174fdb55d6",
        "name": "Send Output in Whatsapp",
        "type": "n8n-nodes-base.twilio",
        "position": [
          640,
          0
        ],
        "parameters": {
          "to": "={{ $('Fetch Whatsapp Request').item.json.body.From.replace('whatsapp:', '') }}",
          "from": "={{ $('Fetch Whatsapp Request').item.json.body.To.replace('whatsapp:', '') }}",
          "message": "={{ $json.text }}",
          "options": {},
          "toWhatsapp": true
        },
        "credentials": {
          "twilioApi": {
            "id": "Dm0RKlu8zVyZcEWb",
            "name": "Twilio account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ede2a3ae-6dc9-486e-999f-dcb9737fd79b",
        "name": "Claude Sonnet 4",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          112,
          208
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-20250514",
            "cachedResultName": "Claude 4 Sonnet"
          },
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "YBCLbX9tu5fuK8V3",
            "name": "Anthropic account Work"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "3c93f1c8-e00e-4791-b10f-02f9c0d82630",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -624,
          -224
        ],
        "parameters": {
          "width": 288,
          "height": 560,
          "content": "### üì≤ WhatsApp Gateway\n\n**Function:** This is the front door. It catches incoming messages from a user via the Twilio webhook.\n\n**Trigger:** Receives a POST request from Twilio.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Output:** Passes the user's message (`body.Body`), their phone number (`body.From`), and the bot's number (`body.To`) to the next nodes.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "198ba40c-5f71-4cef-a69e-fb621829281d",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          -224
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 560,
          "content": "### üß† The AI Research Engine\n\n**Function:** This node is the core researcher. It takes the user's simple question and performs a deep, multi-source dive using Perplexity's powerful `Sonar Pro` model.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n* **Input:** The raw text query from the user.\n* **Output:** A detailed, structured report in raw Markdown, complete with citations and sources. This is the \"first draft\"."
        },
        "typeVersion": 1
      },
      {
        "id": "eada649f-b85c-4696-a670-eeafb6ac2773",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -16,
          -224
        ],
        "parameters": {
          "color": 3,
          "width": 528,
          "height": 560,
          "content": "### üé® The Content Stylist\n\n**Function:** This node acts as an expert editor. It takes the raw research from Perplexity and polishes it into a perfect WhatsApp message.\n\n**Key Actions:** Adds emojis, enforces correct formatting (`bold`), shortens the text to fit the character limit, and removes all conversational filler.\n* **Input:** The raw Markdown report.\n* **Output:** A single, polished, and user-ready text string.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "097b9242-ce57-48a2-9be5-f3e59298b634",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          -224
        ],
        "parameters": {
          "color": 6,
          "width": 320,
          "height": 560,
          "content": "### üöÄ WhatsApp Dispatch\n\n**Function:** This is the final step. It sends the beautifully formatted research summary back to the user who asked for it.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n* **Clever Logic:** It automatically swaps the `From` and `To` numbers from the first node to ensure the reply always goes to the right person.\n* **Action:** Sends the final text from the \"Content Stylist\" node via the Twilio API. Mission complete!"
        },
        "typeVersion": 1
      },
      {
        "id": "c5462997-d89d-4ae6-9d62-d5bca26bd02f",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1008,
          -224
        ],
        "parameters": {
          "color": 5,
          "width": 368,
          "height": 560,
          "content": "## ‚≠ê Workflow Summary\n\n> ### ü§ñ WhatsApp AI Research Assistant\n>\n> This workflow powers a fully automated, on-demand research assistant that operates directly within WhatsApp. It's designed to take any user query received via **Twilio**, understand its core topic, and deliver a comprehensive yet beautifully formatted summary directly back to the user's chat.\n>\n> The process is a seamless four-step data journey:\n> 1.  **Catch (üì≤):** The workflow activates when a user's message is received by the webhook.\n> 2.  **Research (üß†):** The raw query is immediately sent to **Perplexity Sonar** to perform a deep, multi-source web search, generating a fact-based, structured report.\n> 3.  **Polish (üé®):** That raw report is then passed to a **Claude** model, which acts as an expert content editor. It shortens the text, adds engaging emojis, and formats it perfectly for a mobile screen.\n> 4.  **Reply (üí¨):** The final, polished answer is instantly dispatched back to the original user through **Twilio**, completing the entire request in seconds."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "ffca0cbc-b83b-4419-910d-4c05e17be6bf",
    "connections": {
      "Claude Sonnet 4": {
        "ai_languageModel": [
          [
            {
              "node": "Refine Generated Output for Whatsapp",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Perform Deep Research": {
        "main": [
          [
            {
              "node": "Refine Generated Output for Whatsapp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Whatsapp Request": {
        "main": [
          [
            {
              "node": "Perform Deep Research",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Refine Generated Output for Whatsapp": {
        "main": [
          [
            {
              "node": "Send Output in Whatsapp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  "lastUpdatedBy": 29,
  "workflowInfo": {
    "nodeCount": 10,
    "nodeTypes": {
      "n8n-nodes-base.twilio": {
        "count": 1
      },
      "n8n-nodes-base.webhook": {
        "count": 1
      },
      "n8n-nodes-base.perplexity": {
        "count": 1
      },
      "n8n-nodes-base.stickyNote": {
        "count": 5
      },
      "@n8n/n8n-nodes-langchain.chainLlm": {
        "count": 1
      },
      "@n8n/n8n-nodes-langchain.lmChatAnthropic": {
        "count": 1
      }
    }
  },
  "categories": [
    {
      "id": 43,
      "name": "Personal Productivity"
    },
    {
      "id": 47,
      "name": "AI Chatbot"
    }
  ],
  "image": []
}