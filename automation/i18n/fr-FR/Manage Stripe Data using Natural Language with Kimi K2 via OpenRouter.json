{
  "id": 6221,
  "name": "G√©rer les donn√©es Stripe en utilisant le langage naturel avec Kimi K2 via OpenRouter",
  "views": 139,
  "recentViews": 0,
  "totalViews": 139,
  "createdAt": "2025-07-21T10:25:09.277Z",
  "description": "√âlevez vos flux de travail Stripe avec un agent IA qui g√®re intelligemment, en toute s√©curit√© et de mani√®re interactive les op√©rations essentielles sur les donn√©es Stripe. En s'appuyant sur le mod√®le Kimi K2 via OpenRouter, ce mod√®le n8n permet une r√©cup√©ration de donn√©es s√©curis√©e. De l'obtention d'aper√ßus financiers r√©sum√©s √† la gestion des remises clients, tout en respectant strictement la confidentialit√©, des r√©sultats concis et des limites op√©rationnelles.\n\n---\n\n## üßæ Exigences\n\n**Stripe :**\n- Compte Stripe actif\n- Cl√© API avec acc√®s en lecture et √©criture.\n\n**n8n :**\n- Instance n8n d√©ploy√©e (cloud ou auto-h√©berg√©e)\n\n**OpenRouter :**\n- Compte OpenRouter actif avec cr√©dit\n- Cl√© API d'OpenRouter\n\n---\n\n## üîó Liens Utiles\n\n- [Stripe](https://stripe.com)\n- [Configuration des identifiants Stripe dans n8n](https://docs.n8n.io/integrations/builtin/credentials/stripe/)\n- [OpenRouter](https://openrouter.ai/)\n\n---\n\n## üö¶ D√©composition du Flux de Travail\n\n1. **D√©clencheur : Demande de l'utilisateur**\n   - Le flux de travail s'initie lorsqu'un utilisateur authentifi√© envoie un message dans le d√©clencheur de chat.\n\n2. **Agent IA (Kimi K2 OpenRouter) : Analyse d'Intention**\n   - D√©termine si l'utilisateur souhaite :\n     - Lister les clients, les charges ou les coupons\n     - R√©cup√©rer le solde du compte\n     - Cr√©er un nouveau coupon dans Stripe\n   - Filtre les demandes non prises en charge ou peu claires, expliquant les autorisations ou la terminologie si n√©cessaire.\n\n3. **R√©cup√©ration des Donn√©es Stripe**\n   - Pour les requ√™tes de donn√©es :\n     - Ne retourne que des listes r√©sum√©es et masqu√©es (par exemple, les 10 derni√®res transactions/clients)\n     - Les d√©tails sensibles, tels que les num√©ros de carte, sont automatiquement masqu√©s ou tronqu√©s\n     - N'expose jamais ni ne consigne d'informations confidentielles\n\n4. **Cr√©ation de Coupon**\n   - Lorsqu'une cr√©ation de coupon est demand√©e :\n     - L'agent IA collecte les param√®tres du coupon (remise, expiration, restrictions)\n     - R√©sume clairement l'action et **requiert une confirmation explicite de l'utilisateur** avant de proc√©der\n     - Cr√©e le coupon apr√®s confirmation et r√©pond uniquement avec les d√©tails du coupon s√©curis√©s pour le public\n\n---\n\n## üõ°Ô∏è Confidentialit√© & S√©curit√©\n\n- **Aucun stockage de donn√©es :** Toutes les r√©ponses sont √©ph√©m√®res ; les donn√©es sensibles de Stripe ne sont jamais conserv√©es.\n- **Minimisation stricte :** Les r√©sultats sont √©troitement limit√©s ; seuls des identifiants partiels sont affich√©s et uniquement lorsque cela est n√©cessaire.\n- **R√®gles de conservation appliqu√©es :** Aucun journal, exportation ou stockage secondaire des donn√©es Stripe.\n- **Confirmation requise :** Les actions modifiant Stripe (comme la cr√©ation de coupons) n√©cessitent toujours l'approbation de l'utilisateur avant l'ex√©cution.\n- **Pr√™t pour la conformit√© :** Align√© avec Stripe et les normes g√©n√©rales de protection des donn√©es.\n\n---\n\n## ‚è±Ô∏è √âtapes de Configuration\n\n- Temps de configuration : 10‚Äì15 minutes\n- Ajouter les identifiants API Stripe dans n8n\n- Ajouter les identifiants API OpenRouter dans n8n et s√©lectionner votre mod√®le IA souhait√© pour ex√©cuter l'agent. Dans notre mod√®le, nous avons s√©lectionn√© Kimi K2 de Moonshot AI.\n\n---\n\n## ‚úÖ R√©sum√©\n\nCe mod√®le de flux de travail connecte un agent IA priorisant la confidentialit√© (Kimi K2 via OpenRouter) avec votre compte Stripe pour permettre :\n- Un acc√®s rapide et r√©sum√© aux donn√©es clients, transactions, coupons et soldes\n- Cr√©ation s√©curis√©e et confirm√©e de remises/coupons\n- Adh√©sion compl√®te aux meilleures pratiques d'autorisation, de confidentialit√© et op√©rationnelles\n\n---\n\n## üôã‚Äç‚ôÇÔ∏è Besoin d'Aide ?\n\nN'h√©sitez pas √† nous contacter √† [1 Node](https://1node.ai)\nObtenez un acc√®s instantan√© √† une biblioth√®que de [ressources gratuites](https://1node.ai/resources) que nous avons cr√©√©es.",
  "workflow": {
    "id": "lc8NKe6V14iG51T4",
    "meta": {
      "instanceId": "9219ebc7795bea866f70aa3d977d54417fdf06c41944be95e20cfb60f992db19",
      "templateCredsSetupCompleted": true
    },
    "name": "Access Stripe data in natural language with Kimi K2 via OpenRouter",
    "tags": [],
    "nodes": [
      {
        "id": "fc80d268-934e-4bb7-a854-0483732bfb34",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -48,
          -112
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are an AI agent with authorized access to a defined set of Stripe tools. Your core objective is to understand and respond to user queries by securely interacting with Stripe's API, enabling read and write operations in accordance with their requests and permissions.\n\nTool Access and Capabilities\nRead Data Capabilities\nYou can retrieve the following information from Stripe:\nCustomers: Access and list multiple customer records.\nCharges: Retrieve and list multiple charge transactions.\nCoupons: Get lists of existing coupons.\nBalance: Obtain the current balance details.\n\nWrite Data Capabilities\nYou are authorized to:\nCreate Coupons: Generate new coupons within the Stripe system.\n\nStrictly follow these rules:\n\nNever access or attempt to retrieve data outside of the above abilities.\nAlways confirm actions (especially when creating coupons) and provide users with a summary of the resulting Stripe operation.\nClearly explain any Stripe terminology or usage as needed.\nReject and inform users if they request actions beyond your tool permissions.\nYour responses must be concise, accurate, and tailored to the user's intent regarding Stripe operations. \nUse Stripe data responsibly and in line with best practices for financial data access."
          }
        },
        "typeVersion": 2
      },
      {
        "id": "0dc1fc15-7958-4f01-be6d-bed3946d60c9",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          -64,
          112
        ],
        "parameters": {
          "model": "moonshotai/kimi-k2",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "TG7gYjmueITLXr7m",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6edc5f19-be6c-4842-b69d-efc7bb46ad7f",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -256,
          -112
        ],
        "webhookId": "ee12c9ab-62ac-4e5a-b657-4677bcfcf6d0",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "8f520f8d-5085-420a-907f-65958f4ca843",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          80,
          112
        ],
        "parameters": {
          "contextWindowLength": 20
        },
        "typeVersion": 1.3
      },
      {
        "id": "08695c48-3f6d-404d-acca-d799708f101b",
        "name": "Create a coupon in Stripe",
        "type": "n8n-nodes-base.stripeTool",
        "position": [
          320,
          368
        ],
        "parameters": {
          "resource": "coupon",
          "percentOff": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Percent_Off', ``, 'number') }}"
        },
        "credentials": {
          "stripeApi": {
            "id": "zMFMWhEPuLeplXSo",
            "name": "Stripe account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c37f6b38-638b-46f6-a8d9-3ff526a7599b",
        "name": "Get a balance in Stripe",
        "type": "n8n-nodes-base.stripeTool",
        "position": [
          816,
          96
        ],
        "parameters": {},
        "credentials": {
          "stripeApi": {
            "id": "zMFMWhEPuLeplXSo",
            "name": "Stripe account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1adee53c-0f39-44cb-b2c6-83779340bb0b",
        "name": "Get many charges in Stripe",
        "type": "n8n-nodes-base.stripeTool",
        "position": [
          496,
          96
        ],
        "parameters": {
          "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}",
          "resource": "charge",
          "operation": "getAll"
        },
        "credentials": {
          "stripeApi": {
            "id": "zMFMWhEPuLeplXSo",
            "name": "Stripe account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b9c48bc6-a79a-4e2b-bb2f-23837bd936af",
        "name": "Get many coupons in Stripe",
        "type": "n8n-nodes-base.stripeTool",
        "position": [
          672,
          96
        ],
        "parameters": {
          "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}",
          "resource": "coupon",
          "operation": "getAll"
        },
        "credentials": {
          "stripeApi": {
            "id": "zMFMWhEPuLeplXSo",
            "name": "Stripe account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "94ce8cf5-c2cf-4cb5-8a05-2a72c8011213",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          256,
          -32
        ],
        "parameters": {
          "width": 688,
          "height": 304,
          "content": "## Read data\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5f79a25d-eab2-452d-ac07-8ccf3778ac2c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          256,
          288
        ],
        "parameters": {
          "width": 224,
          "height": 256,
          "content": "## Write data"
        },
        "typeVersion": 1
      },
      {
        "id": "4f9598f9-3e48-4979-a1f5-8c64b5c7b44c",
        "name": "Get many customers in Stripe",
        "type": "n8n-nodes-base.stripeTool",
        "position": [
          320,
          96
        ],
        "parameters": {
          "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}",
          "filters": {},
          "resource": "customer",
          "operation": "getAll"
        },
        "credentials": {
          "stripeApi": {
            "id": "zMFMWhEPuLeplXSo",
            "name": "Stripe account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1cfd5b2f-36d7-42c8-ba67-0d2906d0bd93",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -624,
          96
        ],
        "parameters": {
          "color": 5,
          "width": 464,
          "height": 192,
          "content": "## Requirements\n\n- An **Stripe** account and API key credentials enabled. n8n docs: https://docs.n8n.io/integrations/builtin/credentials/stripe/ \n- An **[OpenRouter](https://openrouter.ai)** account and API credentials enabled. Set up an API key at https://openrouter.ai/settings/keys "
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "58807a0c-a099-4d5f-9722-3bfce4363f80",
    "connections": {
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get a balance in Stripe": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create a coupon in Stripe": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get many charges in Stripe": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get many coupons in Stripe": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get many customers in Stripe": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  "lastUpdatedBy": 29,
  "workflowInfo": {
    "nodeCount": 12,
    "nodeTypes": {
      "n8n-nodes-base.stickyNote": {
        "count": 3
      },
      "n8n-nodes-base.stripeTool": {
        "count": 5
      },
      "@n8n/n8n-nodes-langchain.agent": {
        "count": 1
      },
      "@n8n/n8n-nodes-langchain.chatTrigger": {
        "count": 1
      },
      "@n8n/n8n-nodes-langchain.lmChatOpenRouter": {
        "count": 1
      },
      "@n8n/n8n-nodes-langchain.memoryBufferWindow": {
        "count": 1
      }
    }
  },
  "user": {
    "name": "Aitor | 1Node",
    "username": "aitoralonso",
    "bio": "Hi, I'm Aitor with 1 Node. We create practical AI solutions for businesses. Nothing fancy, just tools that solve real problems and help you scale. Always happy to have a conversation about how we might be able to help you grow",
    "verified": true,
    "links": [
      "https://1node.ai"
    ],
    "avatar": "https://gravatar.com/avatar/2f850f7b4c218087a3e7d9775daf6bd8dad05b5eb5ea82242d4bfd1a97465455?r=pg&d=retro&size=200"
  },
  "nodes": [
    {
      "id": 565,
      "icon": "fa:sticky-note",
      "name": "n8n-nodes-base.stickyNote",
      "codex": {
        "data": {
          "alias": [
            "Comments",
            "Notes",
            "Sticky"
          ],
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"input\"]",
      "defaults": {
        "name": "Note Collante",
        "color": "#FFD233"
      },
      "iconData": {
        "icon": "sticky-note",
        "type": "icon"
      },
      "displayName": "Sticky Note",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 1119,
      "icon": "fa:robot",
      "name": "@n8n/n8n-nodes-langchain.agent",
      "codex": {
        "data": {
          "alias": [
            "LangChain",
            "Chat",
            "Conversational",
            "Plan and Execute",
            "ReAct",
            "Tools"
          ],
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/"
              }
            ]
          },
          "categories": [
            "AI",
            "Langchain"
          ],
          "subcategories": {
            "AI": [
              "Agents",
              "Root Nodes"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Agent IA",
        "color": "#404040"
      },
      "iconData": {
        "icon": "robot",
        "type": "icon"
      },
      "displayName": "AI Agent",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 25,
          "name": "AI"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    },
    {
      "id": 1163,
      "icon": "fa:database",
      "name": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "codex": {
        "data": {
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.memorybufferwindow/"
              }
            ]
          },
          "categories": [
            "AI",
            "Langchain"
          ],
          "subcategories": {
            "AI": [
              "Memory"
            ],
            "Memory": [
              "For beginners"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "M√©moire Simple"
      },
      "iconData": {
        "icon": "database",
        "type": "icon"
      },
      "displayName": "Simple Memory",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 25,
          "name": "AI"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    },
    {
      "id": 1247,
      "icon": "fa:comments",
      "name": "@n8n/n8n-nodes-langchain.chatTrigger",
      "codex": {
        "data": {
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.chattrigger/"
              }
            ]
          },
          "categories": [
            "Core Nodes",
            "Langchain"
          ]
        }
      },
      "group": "[\"trigger\"]",
      "defaults": {
        "name": "Lorsque le message de chat est re√ßu"
      },
      "iconData": {
        "icon": "comments",
        "type": "icon"
      },
      "displayName": "Chat Trigger",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    },
    {
      "id": 1281,
      "icon": "file:openrouter.svg",
      "name": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "codex": {
        "data": {
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatopenrouter/"
              }
            ]
          },
          "categories": [
            "AI",
            "Langchain"
          ],
          "subcategories": {
            "AI": [
              "Language Models",
              "Root Nodes"
            ],
            "Language Models": [
              "Chat Models (Recommended)"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Mod√®le de Chat OpenRouter"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjOTRBM0I4IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjx0aXRsZT5PcGVuUm91dGVyPC90aXRsZT48cGF0aCBkPSJNMTYuODA0IDEuOTU3bDcuMjIgNC4xMDV2LjA4N0wxNi43MyAxMC4yMWwuMDE3LTIuMTE3LS44MjEtLjAzYy0xLjA1OS0uMDI4LTEuNjExLjAwMi0yLjI2OC4xMS0xLjA2NC4xNzUtMi4wMzguNTc3LTMuMTQ3IDEuMzUyTDguMzQ1IDExLjAzYy0uMjg0LjE5NS0uNDk1LjMzNi0uNjguNDU1bC0uNTE1LjMyMi0uMzk3LjIzNC4zODUuMjMuNTMuMzM4Yy40NzYuMzE0IDEuMTcuNzk2IDIuNzAxIDEuODY2IDEuMTEuNzc1IDIuMDgzIDEuMTc3IDMuMTQ3IDEuMzUybC4zLjA0NWMuNjk0LjA5MSAxLjM3NS4wOTQgMi44MjUuMDMzbC4wMjItMi4xNTkgNy4yMiA0LjEwNXYuMDg3TDE2LjU4OSAyMmwuMDE0LTEuODYyLS42MzUuMDIyYy0xLjM4Ni4wNDItMi4xMzcuMDAyLTMuMTM4LS4xNjItMS42OTQtLjI4LTMuMjYtLjkyNi00Ljg4MS0yLjA1OWwtMi4xNTgtMS41YTIxLjk5NyAyMS45OTcgMCAwMC0uNzU1LS40OThsLS40NjctLjI4YTU1LjkyNyA1NS45MjcgMCAwMC0uNzYtLjQzQzIuOTA4IDE0LjczLjU2MyAxNC4xMTYgMCAxNC4xMTZWOS44ODhsLjE0LjAwNGMuNTY0LS4wMDcgMi45MS0uNjIyIDMuODA5LTEuMTI0bDEuMDE2LS41OC40MzgtLjI3NGMuNDI4LS4yOCAxLjA3Mi0uNzI2IDIuNjg2LTEuODUzIDEuNjIxLTEuMTMzIDMuMTg2LTEuNzggNC44ODEtMi4wNTkgMS4xNTItLjE5IDEuOTc0LS4yMTMgMy44MTQtLjEzOGwuMDItMS45MDd6Ij48L3BhdGg+PC9zdmc+Cg=="
      },
      "displayName": "OpenRouter Chat Model",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 25,
          "name": "AI"
        },
        {
          "id": 26,
          "name": "Langchain"
        }
      ]
    }
  ],
  "categories": [
    {
      "id": 39,
      "name": "CRM"
    },
    {
      "id": 47,
      "name": "Chatbot IA"
    }
  ],
  "image": []
}