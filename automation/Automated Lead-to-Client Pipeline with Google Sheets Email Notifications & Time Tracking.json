{
  "id": 7514,
  "name": "Automated Lead-to-Client Pipeline with Google Sheets Email Notifications & Time Tracking",
  "totalViews": 30,
  "purchaseUrl": null,
  "user": {
    "name": "Ziad Adel",
    "username": "ziadadel",
    "bio": "Building in Public | Goodwill | Follow me on socials",
    "verified": true,
    "links": [
      "www.instagram.com/ziadadel.ai"
    ],
    "avatar": "https://gravatar.com/avatar/33a9d8735a8bafca5e9237a24ee9d48a1c91068a5cc96bfd244f4179a4312fef?r=pg&d=retro&size=200"
  },
  "description": "## Google Sheets CRM Automations: Lead Stages ‚Üí Emails, Client Tracking & Delivery Duration\n\n*Turn a simple Google Sheet into a lightweight CRM powered by n8n.*\n\n---\n\n## Overview\nThis template monitors edits in your **Leads** and **Clients** tabs and reacts automatically:\n- **Qualified?** ‚Üí sends a Cal.com booking email  \n- **Stage ‚Üí Awaiting Proposal** ‚Üí sends a ‚Äúproposal coming soon‚Äù email  \n- **Stage ‚Üí Won** ‚Üí appends the client to **Clients** with a **Start Date & Time**  \n- **Clients: Project Status ‚Üí Delivered** ‚Üí stamps **End Date & Time** and computes **Time to Deliver** (e.g., `2d 5h 30m`)\n\n---\n\n## What This Template Does\n- **Lead Qualification ‚Üí Email**: When you mark **Qualified?** in **Leads**, a booking email is sent automatically.  \n- **Awaiting Proposal ‚Üí Email**: Sends a heads-up email that a proposal is coming soon.  \n- **Won ‚Üí Client Append**: Adds the client to **Clients** and records the start timestamp.  \n- **Delivered ‚Üí Completion Metrics**: Looks up the client, stamps the end timestamp, and calculates the delivery duration.\n\n---\n\n## How It Works\n1. **Google Apps Script ‚Üí Webhooks (onEdit)**\n   - A small Apps Script (provided in the workflow‚Äôs Sticky Note) watches the sheet and posts JSON to these n8n webhooks:\n     - `/webhook/lead-stage-changed`\n     - `/webhook/lead-qualified`\n     - `/webhook/client-status-changed`\n\n2. **n8n Flow & Branching**\n   - **lead-stage-changed**\n     - If **Awaiting Proposal** ‚Üí send proposal heads-up email\n     - If **Won** ‚Üí format timestamp ‚Üí append to **Clients**\n   - **lead-qualified**\n     - If `qualified = true` ‚Üí send **Cal.com** booking email\n   - **client-status-changed**\n     - If **Delivered** ‚Üí lookup client row ‚Üí stamp **End Date & Time** ‚Üí compute **Time to Deliver** ‚Üí update row\n\n---\n\n## Prerequisites\n- Google Sheet with two tabs: **Leads** and **Clients**\n- Gmail account (or use your preferred email/notification node)\n- n8n instance with:\n  - **Google Sheets OAuth2** credentials\n  - **Gmail OAuth2** credentials (if using the Gmail node)\n\n**Suggested columns**\n- **Leads**: `Name (A)`, `Client Email (C)`, `Lead Source (D)`, `Stage (E)`, `Qualified? (H)`\n- **Clients**: `Name (A)`, `Client Email (C)`, `Project Status (D)`, `Start Date & Time (F)`, `End Date & Time (G)`, `Time to Deliver (H)`\n\n---\n\n## Setup Steps\n1. **Copy/prepare the Google Sheet**\n   - Ensure both **Leads** and **Clients** tabs exist with the columns above.\n\n2. **Install the Apps Script**\n   - In Google Sheets: **Extensions ‚Üí Apps Script** ‚Üí paste the script from the workflow‚Äôs Sticky Note.\n   - Replace webhook URLs with your n8n endpoints:\n     - `https://{{YOUR_N8N_DOMAIN}}/webhook/lead-stage-changed`\n     - `https://{{YOUR_N8N_DOMAIN}}/webhook/lead-qualified`\n     - `https://{{YOUR_N8N_DOMAIN}}/webhook/client-status-changed`\n   - Run `createInstallableTrigger()` once to enable `onEdit`.\n\n3. **Open the workflow in n8n & replace placeholders**\n   - `{{GOOGLE_SHEETS_DOC_ID}}`\n   - `{{LEADS_GID}}`\n   - `{{CLIENTS_GID}}`\n   - `{{CAL_COM_BOOKING_URL}}`\n   - `{{SENDER_NAME}}`\n   - `{{GMAIL_CREDENTIAL_ID}}`, `{{GMAIL_CREDENTIAL_NAME}}`\n   - `{{GSHEETS_CREDENTIAL_ID}}`, `{{GSHEETS_CREDENTIAL_NAME}}`\n\n4. **Connect credentials**\n   - Authorize **Google Sheets OAuth2** and **Gmail OAuth2** (or switch to SMTP/another email node).\n\n5. **Activate & test**\n   - Toggle **Qualified?** on a test row or change **Stage** to **Awaiting Proposal/Won**.\n   - Verify the email, client append, and duration updates flow end-to-end.\n\n---\n\n## Customization Ideas\n- Swap **Gmail** with **SMTP**, **Outlook**, or **Slack** messages.\n- Add a **Stage = Lost** branch to trigger a re-engagement sequence.\n- Add guards to prevent duplicate appends to **Clients**.\n- Localize email copy and date formats.\n\n---\n\n## Troubleshooting\n- **Nothing triggers**: Confirm Apps Script URLs and that `createInstallableTrigger()` was run.  \n- **Wrong tab/GID**: Open each tab and copy its `gid` from the URL; update placeholders.  \n- **Credential errors**: Re-authorize Google Sheets/Gmail OAuth2 in n8n.  \n- **Wrong first name**: Ensure `Name` in **Leads** follows `First Last`; the workflow splits the first token.\n\n---\n## Video Walkthrough Demo\n\n[Screen Studio Template Demo Video](https://screen.studio/share/f3sNqd9N?private-access=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzaGFyZWFibGVMaW5rSWQiOiJjMTMyZjY0Ny1hODg3LTQzNzctYWUwMi1kMzgyM2E5ZmI2OTkiLCJpYXQiOjE3NTU0MzEyNzB9.6PquB48GkV8T6Ytsg9kVEK1eDaBge9yqxS4jKyTbVXg)",
  "createdAt": "2025-08-17T11:51:34.078Z",
  "nodes": [
    {
      "id": 18,
      "icon": "file:googleSheets.svg",
      "name": "n8n-nodes-base.googleSheets",
      "codex": {
        "data": {
          "alias": [
            "CSV",
            "Sheet",
            "Spreadsheet",
            "GS"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/love-at-first-sight-ricardos-n8n-journey/",
                "icon": "‚ù§Ô∏è",
                "label": "Love at first sight: Ricardo‚Äôs n8n journey"
              },
              {
                "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                "icon": "üß¨",
                "label": "Why business process automation with n8n can change your daily life"
              },
              {
                "url": "https://n8n.io/blog/automatically-adding-expense-receipts-to-google-sheets-with-telegram-mindee-twilio-and-n8n/",
                "icon": "üßæ",
                "label": "Automatically Adding Expense Receipts to Google Sheets with Telegram, Mindee, Twilio, and n8n"
              },
              {
                "url": "https://n8n.io/blog/supercharging-your-conference-registration-process-with-n8n/",
                "icon": "üé´",
                "label": "Supercharging your conference registration process with n8n"
              },
              {
                "url": "https://n8n.io/blog/creating-triggers-for-n8n-workflows-using-polling/",
                "icon": "‚è≤",
                "label": "Creating triggers for n8n workflows using polling"
              },
              {
                "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                "icon": "store",
                "label": "6 e-commerce workflows to power up your Shopify s"
              },
              {
                "url": "https://n8n.io/blog/migrating-community-metrics-to-orbit-using-n8n/",
                "icon": "üìà",
                "label": "Migrating Community Metrics to Orbit using n8n"
              },
              {
                "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                "icon": "üí°",
                "label": "15 Google apps you can combine and automate to increase productivity"
              },
              {
                "url": "https://n8n.io/blog/your-business-doesnt-need-you-to-operate/",
                "icon": " üñ•Ô∏è",
                "label": "Hey founders! Your business doesn't need you to operate"
              },
              {
                "url": "https://n8n.io/blog/how-honest-burgers-use-automation-to-save-100k-per-year/",
                "icon": "üçî",
                "label": "How Honest Burgers Use Automation to Save $100k per year"
              },
              {
                "url": "https://n8n.io/blog/how-a-digital-strategist-uses-n8n-for-online-marketing/",
                "icon": "üíª",
                "label": "How a digital strategist uses n8n for online marketing"
              },
              {
                "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                "icon": "üß†",
                "label": "Why this Product Manager loves workflow automation with n8n"
              },
              {
                "url": "https://n8n.io/blog/sending-automated-congratulations-with-google-sheets-twilio-and-n8n/",
                "icon": "üôå",
                "label": "Sending Automated Congratulations with Google Sheets, Twilio, and n8n "
              },
              {
                "url": "https://n8n.io/blog/how-a-membership-development-manager-automates-his-work-and-investments/",
                "icon": "üìà",
                "label": "How a Membership Development Manager automates his work and investments"
              },
              {
                "url": "https://n8n.io/blog/aws-workflow-automation/",
                "label": "7 no-code workflow automations for Amazon Web Services"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets/"
              }
            ],
            "credentialDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/"
              }
            ]
          },
          "categories": [
            "Data & Storage",
            "Productivity"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0"
        }
      },
      "group": "[\"input\",\"output\"]",
      "defaults": {
        "name": "Google Sheets"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGZpbGw9IiMyOEI0NDYiIGQ9Ik0zNS42OSAxIDUyIDE3LjIyNXYzOS4wODdhMy42NyAzLjY3IDAgMCAxLTEuMDg0IDIuNjFBMy43IDMuNyAwIDAgMSA0OC4yOTMgNjBIMTIuNzA3YTMuNyAzLjcgMCAwIDEtMi42MjMtMS4wNzhBMy42NyAzLjY3IDAgMCAxIDkgNTYuMzEyVjQuNjg4YTMuNjcgMy42NyAwIDAgMSAxLjA4NC0yLjYxQTMuNyAzLjcgMCAwIDEgMTIuNzA3IDF6Ii8+PHBhdGggZmlsbD0iIzZBQ0U3QyIgZD0iTTM1LjY5IDEgNTIgMTcuMjI1SDM5LjM5N2MtMi4wNTQgMC0zLjcwNy0xLjgyOS0zLjcwNy0zLjg3MnoiLz48cGF0aCBmaWxsPSIjMjE5QjM4IiBkPSJNMzkuMjExIDE3LjIyNSA1MiAyMi40OHYtNS4yNTV6Ii8+PHBhdGggZmlsbD0iI0ZGRiIgZD0iTTIwLjEyIDMxLjk3NWMwLS44MTcuNjYyLTEuNDc1IDEuNDgzLTEuNDc1aDE3Ljc5NGMuODIxIDAgMS40ODIuNjU4IDEuNDgyIDEuNDc1djE1LjQ4N2MwIC44MTgtLjY2MSAxLjQ3NS0xLjQ4MiAxLjQ3NUgyMS42MDNhMS40NzYgMS40NzYgMCAwIDEtMS40ODItMS40NzRWMzEuOTc0em0yLjIyNSAxLjQ3NWg2LjY3MnYyLjIxMmgtNi42NzJ6bTAgNS4xNjJoNi42NzJ2Mi4yMTNoLTYuNjcyem0wIDUuMTYzaDYuNjcydjIuMjEyaC02LjY3MnptOS42MzgtMTAuMzI1aDYuNjcydjIuMjEyaC02LjY3MnptMCA1LjE2Mmg2LjY3MnYyLjIxM2gtNi42NzJ6bTAgNS4xNjNoNi42NzJ2Mi4yMTJoLTYuNjcyeiIvPjxwYXRoIGZpbGw9IiMyOEI0NDYiIGQ9Ik0zNC42OSAwIDUxIDE2LjIyNXYzOS4wODdhMy42NyAzLjY3IDAgMCAxLTEuMDg0IDIuNjFBMy43IDMuNyAwIDAgMSA0Ny4yOTMgNTlIMTEuNzA3YTMuNyAzLjcgMCAwIDEtMi42MjMtMS4wNzhBMy42NyAzLjY3IDAgMCAxIDggNTUuMzEyVjMuNjg4YTMuNjcgMy42NyAwIDAgMSAxLjA4NC0yLjYxQTMuNyAzLjcgMCAwIDEgMTEuNzA3IDB6Ii8+PHBhdGggZmlsbD0iIzZBQ0U3QyIgZD0iTTM0LjY5IDAgNTEgMTYuMjI1SDM4LjM5N2MtMi4wNTQgMC0zLjcwNy0xLjgyOS0zLjcwNy0zLjg3MnoiLz48cGF0aCBmaWxsPSIjMjE5QjM4IiBkPSJNMzguMjExIDE2LjIyNSA1MSAyMS40OHYtNS4yNTV6Ii8+PHBhdGggZmlsbD0iI0ZGRiIgZD0iTTE5LjEyIDMwLjk3NWMwLS44MTcuNjYyLTEuNDc1IDEuNDgzLTEuNDc1aDE3Ljc5NGMuODIxIDAgMS40ODIuNjU4IDEuNDgyIDEuNDc1djE1LjQ4N2MwIC44MTgtLjY2MSAxLjQ3NS0xLjQ4MiAxLjQ3NUgyMC42MDNhMS40NzYgMS40NzYgMCAwIDEtMS40ODItMS40NzRWMzAuOTc0em0yLjIyNSAxLjQ3NWg2LjY3MnYyLjIxMmgtNi42NzJ6bTAgNS4xNjJoNi42NzJ2Mi4yMTNoLTYuNjcyem0wIDUuMTYzaDYuNjcydjIuMjEyaC02LjY3MnptOS42MzgtMTAuMzI1aDYuNjcydjIuMjEyaC02LjY3MnptMCA1LjE2Mmg2LjY3MnYyLjIxM2gtNi42NzJ6bTAgNS4xNjNoNi42NzJ2Mi4yMTJoLTYuNjcyeiIvPjwvZz48L3N2Zz4="
      },
      "displayName": "Google Sheets",
      "typeVersion": 5,
      "nodeCategories": [
        {
          "id": 3,
          "name": "Data & Storage"
        },
        {
          "id": 4,
          "name": "Productivity"
        }
      ]
    },
    {
      "id": 20,
      "icon": "fa:map-signs",
      "name": "n8n-nodes-base.if",
      "codex": {
        "data": {
          "alias": [
            "Router",
            "Filter",
            "Condition",
            "Logic",
            "Boolean",
            "Branch"
          ],
          "details": "The IF node can be used to implement binary conditional logic in your workflow. You can set up one-to-many conditions to evaluate each item of data being inputted into the node. That data will either evaluate to TRUE or FALSE and route out of the node accordingly.\n\nThis node has multiple types of conditions: Bool, String, Number, and Date & Time.",
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/",
                "icon": "üè≠",
                "label": "Learn to Automate Your Factory's Incident Reporting: A Step by Step Guide"
              },
              {
                "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                "icon": "‚òÄÔ∏è",
                "label": "2021: The Year to Automate the New You with n8n"
              },
              {
                "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                "icon": "üß¨",
                "label": "Why business process automation with n8n can change your daily life"
              },
              {
                "url": "https://n8n.io/blog/create-a-toxic-language-detector-for-telegram/",
                "icon": "ü§¨",
                "label": "Create a toxic language detector for Telegram in 4 step"
              },
              {
                "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                "icon": "store",
                "label": "6 e-commerce workflows to power up your Shopify s"
              },
              {
                "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                "icon": "üîó",
                "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
              },
              {
                "url": "https://n8n.io/blog/automate-your-data-processing-pipeline-in-9-steps-with-n8n/",
                "icon": "‚öôÔ∏è",
                "label": "Automate your data processing pipeline in 9 steps"
              },
              {
                "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                "icon": "üë•",
                "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
              },
              {
                "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                "icon": "‚ö°Ô∏è",
                "label": "5 tasks you can automate with the new Notion API "
              },
              {
                "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                "icon": "üí°",
                "label": "15 Google apps you can combine and automate to increase productivity"
              },
              {
                "url": "https://n8n.io/blog/automation-for-maintainers-of-open-source-projects/",
                "icon": "üè∑Ô∏è",
                "label": "How to automatically manage contributions to open-source projects"
              },
              {
                "url": "https://n8n.io/blog/how-uproc-scraped-a-multi-page-website-with-a-low-code-workflow/",
                "icon": " üï∏Ô∏è",
                "label": "How uProc scraped a multi-page website with a low-code workflow"
              },
              {
                "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                "icon": "ü§ñ",
                "label": "5 workflow automations for Mattermost that we love at n8n"
              },
              {
                "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                "icon": "üß†",
                "label": "Why this Product Manager loves workflow automation with n8n"
              },
              {
                "url": "https://n8n.io/blog/sending-automated-congratulations-with-google-sheets-twilio-and-n8n/",
                "icon": "üôå",
                "label": "Sending Automated Congratulations with Google Sheets, Twilio, and n8n "
              },
              {
                "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                "icon": "üé°",
                "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
              },
              {
                "url": "https://n8n.io/blog/benefits-of-automation-and-n8n-an-interview-with-hubspots-hugh-durkin/",
                "icon": "üéñ",
                "label": "Benefits of automation and n8n: An interview with HubSpot's Hugh Durkin"
              },
              {
                "url": "https://n8n.io/blog/aws-workflow-automation/",
                "label": "7 no-code workflow automations for Amazon Web Services"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.if/"
              }
            ]
          },
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Flow"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "If",
        "color": "#408000"
      },
      "iconData": {
        "icon": "map-signs",
        "type": "icon"
      },
      "displayName": "If",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 38,
      "icon": "fa:pen",
      "name": "n8n-nodes-base.set",
      "codex": {
        "data": {
          "alias": [
            "Set",
            "JS",
            "JSON",
            "Filter",
            "Transform",
            "Map"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/learn-to-automate-your-factorys-incident-reporting-a-step-by-step-guide/",
                "icon": "üè≠",
                "label": "Learn to Automate Your Factory's Incident Reporting: A Step by Step Guide"
              },
              {
                "url": "https://n8n.io/blog/2021-the-year-to-automate-the-new-you-with-n8n/",
                "icon": "‚òÄÔ∏è",
                "label": "2021: The Year to Automate the New You with n8n"
              },
              {
                "url": "https://n8n.io/blog/automatically-pulling-and-visualizing-data-with-n8n/",
                "icon": "üìà",
                "label": "Automatically pulling and visualizing data with n8n"
              },
              {
                "url": "https://n8n.io/blog/database-monitoring-and-alerting-with-n8n/",
                "icon": "üì°",
                "label": "Database Monitoring and Alerting with n8n"
              },
              {
                "url": "https://n8n.io/blog/automatically-adding-expense-receipts-to-google-sheets-with-telegram-mindee-twilio-and-n8n/",
                "icon": "üßæ",
                "label": "Automatically Adding Expense Receipts to Google Sheets with Telegram, Mindee, Twilio, and n8n"
              },
              {
                "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                "icon": "store",
                "label": "6 e-commerce workflows to power up your Shopify s"
              },
              {
                "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                "icon": "üîó",
                "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
              },
              {
                "url": "https://n8n.io/blog/automate-your-data-processing-pipeline-in-9-steps-with-n8n/",
                "icon": "‚öôÔ∏è",
                "label": "Automate your data processing pipeline in 9 steps"
              },
              {
                "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                "icon": "üë•",
                "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
              },
              {
                "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                "icon": "‚ö°Ô∏è",
                "label": "5 tasks you can automate with the new Notion API "
              },
              {
                "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                "icon": "üí°",
                "label": "15 Google apps you can combine and automate to increase productivity"
              },
              {
                "url": "https://n8n.io/blog/how-uproc-scraped-a-multi-page-website-with-a-low-code-workflow/",
                "icon": " üï∏Ô∏è",
                "label": "How uProc scraped a multi-page website with a low-code workflow"
              },
              {
                "url": "https://n8n.io/blog/building-an-expense-tracking-app-in-10-minutes/",
                "icon": "üì±",
                "label": "Building an expense tracking app in 10 minutes"
              },
              {
                "url": "https://n8n.io/blog/the-ultimate-guide-to-automate-your-video-collaboration-with-whereby-mattermost-and-n8n/",
                "icon": "üìπ",
                "label": "The ultimate guide to automate your video collaboration with Whereby, Mattermost, and n8n"
              },
              {
                "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                "icon": "ü§ñ",
                "label": "5 workflow automations for Mattermost that we love at n8n"
              },
              {
                "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                "icon": "üß∞",
                "label": "Learn to Build Powerful API Endpoints Using Webhooks"
              },
              {
                "url": "https://n8n.io/blog/how-a-membership-development-manager-automates-his-work-and-investments/",
                "icon": "üìà",
                "label": "How a Membership Development Manager automates his work and investments"
              },
              {
                "url": "https://n8n.io/blog/a-low-code-bitcoin-ticker-built-with-questdb-and-n8n-io/",
                "icon": "üìà",
                "label": "A low-code bitcoin ticker built with QuestDB and n8n.io"
              },
              {
                "url": "https://n8n.io/blog/how-to-set-up-a-ci-cd-pipeline-with-no-code/",
                "icon": "üé°",
                "label": "How to set up a no-code CI/CD pipeline with GitHub and TravisCI"
              },
              {
                "url": "https://n8n.io/blog/benefits-of-automation-and-n8n-an-interview-with-hubspots-hugh-durkin/",
                "icon": "üéñ",
                "label": "Benefits of automation and n8n: An interview with HubSpot's Hugh Durkin"
              },
              {
                "url": "https://n8n.io/blog/how-goomer-automated-their-operations-with-over-200-n8n-workflows/",
                "icon": "üõµ",
                "label": "How Goomer automated their operations with over 200 n8n workflows"
              },
              {
                "url": "https://n8n.io/blog/aws-workflow-automation/",
                "label": "7 no-code workflow automations for Amazon Web Services"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.set/"
              }
            ]
          },
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Data Transformation"
            ]
          }
        }
      },
      "group": "[\"input\"]",
      "defaults": {
        "name": "Edit Fields"
      },
      "iconData": {
        "icon": "pen",
        "type": "icon"
      },
      "displayName": "Edit Fields (Set)",
      "typeVersion": 3,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 47,
      "icon": "file:webhook.svg",
      "name": "n8n-nodes-base.webhook",
      "codex": {
        "data": {
          "alias": [
            "HTTP",
            "API",
            "Build",
            "WH"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/learn-how-to-automatically-cross-post-your-content-with-n8n/",
                "icon": "‚úçÔ∏è",
                "label": "Learn how to automatically cross-post your content with n8n"
              },
              {
                "url": "https://n8n.io/blog/running-n8n-on-ships-an-interview-with-maranics/",
                "icon": "üõ≥",
                "label": "Running n8n on ships: An interview with Maranics"
              },
              {
                "url": "https://n8n.io/blog/how-to-build-a-low-code-self-hosted-url-shortener/",
                "icon": "üîó",
                "label": "How to build a low-code, self-hosted URL shortener in 3 steps"
              },
              {
                "url": "https://n8n.io/blog/what-are-apis-how-to-use-them-with-no-code/",
                "icon": " ü™¢",
                "label": "What are APIs and how to use them with no code"
              },
              {
                "url": "https://n8n.io/blog/5-tasks-you-can-automate-with-notion-api/",
                "icon": "‚ö°Ô∏è",
                "label": "5 tasks you can automate with the new Notion API "
              },
              {
                "url": "https://n8n.io/blog/how-a-digital-strategist-uses-n8n-for-online-marketing/",
                "icon": "üíª",
                "label": "How a digital strategist uses n8n for online marketing"
              },
              {
                "url": "https://n8n.io/blog/the-ultimate-guide-to-automate-your-video-collaboration-with-whereby-mattermost-and-n8n/",
                "icon": "üìπ",
                "label": "The ultimate guide to automate your video collaboration with Whereby, Mattermost, and n8n"
              },
              {
                "url": "https://n8n.io/blog/how-to-automatically-give-kudos-to-contributors-with-github-slack-and-n8n/",
                "icon": "üëè",
                "label": "How to automatically give kudos to contributors with GitHub, Slack, and n8n"
              },
              {
                "url": "https://n8n.io/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/",
                "icon": "ü§ñ",
                "label": "5 workflow automations for Mattermost that we love at n8n"
              },
              {
                "url": "https://n8n.io/blog/why-this-product-manager-loves-workflow-automation-with-n8n/",
                "icon": "üß†",
                "label": "Why this Product Manager loves workflow automation with n8n"
              },
              {
                "url": "https://n8n.io/blog/creating-custom-incident-response-workflows-with-n8n/",
                "label": "How to automate every step of an incident response workflow"
              },
              {
                "url": "https://n8n.io/blog/learn-to-build-powerful-api-endpoints-using-webhooks/",
                "icon": "üß∞",
                "label": "Learn to Build Powerful API Endpoints Using Webhooks"
              },
              {
                "url": "https://n8n.io/blog/learn-how-to-use-webhooks-with-mattermost-slash-commands/",
                "icon": "ü¶Ñ",
                "label": "Learn how to use webhooks with Mattermost slash commands"
              },
              {
                "url": "https://n8n.io/blog/how-goomer-automated-their-operations-with-over-200-n8n-workflows/",
                "icon": "üõµ",
                "label": "How Goomer automated their operations with over 200 n8n workflows"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.webhook/"
              }
            ]
          },
          "categories": [
            "Development",
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"trigger\"]",
      "defaults": {
        "name": "Webhook"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCI+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTM1IDM3Yy0yLjIgMC00LTEuOC00LTRzMS44LTQgNC00IDQgMS44IDQgNC0xLjggNC00IDQiLz48cGF0aCBmaWxsPSIjMzc0NzRmIiBkPSJNMzUgNDNjLTMgMC01LjktMS40LTcuOC0zLjdsMy4xLTIuNWMxLjEgMS40IDIuOSAyLjMgNC43IDIuMyAzLjMgMCA2LTIuNyA2LTZzLTIuNy02LTYtNmMtMSAwLTIgLjMtMi45LjdsLTEuNyAxTDIzLjMgMTZsMy41LTEuOSA1LjMgOS40YzEtLjMgMi0uNSAzLS41IDUuNSAwIDEwIDQuNSAxMCAxMFM0MC41IDQzIDM1IDQzIi8+PHBhdGggZmlsbD0iIzM3NDc0ZiIgZD0iTTE0IDQzQzguNSA0MyA0IDM4LjUgNCAzM2MwLTQuNiAzLjEtOC41IDcuNS05LjdsMSAzLjlDOS45IDI3LjkgOCAzMC4zIDggMzNjMCAzLjMgMi43IDYgNiA2czYtMi43IDYtNnYtMmgxNXY0SDIzLjhjLS45IDQuNi01IDgtOS44IDgiLz48cGF0aCBmaWxsPSIjZTkxZTYzIiBkPSJNMTQgMzdjLTIuMiAwLTQtMS44LTQtNHMxLjgtNCA0LTQgNCAxLjggNCA0LTEuOCA0LTQgNCIvPjxwYXRoIGZpbGw9IiMzNzQ3NGYiIGQ9Ik0yNSAxOWMtMi4yIDAtNC0xLjgtNC00czEuOC00IDQtNCA0IDEuOCA0IDQtMS44IDQtNCA0Ii8+PHBhdGggZmlsbD0iI2U5MWU2MyIgZD0ibTE1LjcgMzQtMy40LTIgNS45LTkuN2MtMi0xLjktMy4yLTQuNS0zLjItNy4zIDAtNS41IDQuNS0xMCAxMC0xMHMxMCA0LjUgMTAgMTBjMCAuOS0uMSAxLjctLjMgMi41bC0zLjktMWMuMS0uNS4yLTEgLjItMS41IDAtMy4zLTIuNy02LTYtNnMtNiAyLjctNiA2YzAgMi4xIDEuMSA0IDIuOSA1LjFsMS43IDF6Ii8+PC9zdmc+"
      },
      "displayName": "Webhook",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 5,
          "name": "Development"
        },
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 221,
      "icon": "fa:clock",
      "name": "n8n-nodes-base.dateTime",
      "codex": {
        "data": {
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                "icon": "store",
                "label": "6 e-commerce workflows to power up your Shopify s"
              },
              {
                "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                "icon": "üë•",
                "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.datetime/"
              }
            ]
          },
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Data Transformation"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Date & Time",
        "color": "#408000"
      },
      "iconData": {
        "icon": "clock",
        "type": "icon"
      },
      "displayName": "Date & Time",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 356,
      "icon": "file:gmail.svg",
      "name": "n8n-nodes-base.gmail",
      "codex": {
        "data": {
          "alias": [
            "email",
            "human",
            "form",
            "wait",
            "hitl",
            "approval"
          ],
          "resources": {
            "generic": [
              {
                "url": "https://n8n.io/blog/why-business-process-automation-with-n8n-can-change-your-daily-life/",
                "icon": "üß¨",
                "label": "Why business process automation with n8n can change your daily life"
              },
              {
                "url": "https://n8n.io/blog/supercharging-your-conference-registration-process-with-n8n/",
                "icon": "üé´",
                "label": "Supercharging your conference registration process with n8n"
              },
              {
                "url": "https://n8n.io/blog/no-code-ecommerce-workflow-automations/",
                "icon": "store",
                "label": "6 e-commerce workflows to power up your Shopify s"
              },
              {
                "url": "https://n8n.io/blog/how-to-get-started-with-crm-automation-and-no-code-workflow-ideas/",
                "icon": "üë•",
                "label": "How to get started with CRM automation (with 3 no-code workflow ideas"
              },
              {
                "url": "https://n8n.io/blog/automate-google-apps-for-productivity/",
                "icon": "üí°",
                "label": "15 Google apps you can combine and automate to increase productivity"
              },
              {
                "url": "https://n8n.io/blog/your-business-doesnt-need-you-to-operate/",
                "icon": " üñ•Ô∏è",
                "label": "Hey founders! Your business doesn't need you to operate"
              },
              {
                "url": "https://n8n.io/blog/using-automation-to-boost-productivity-in-the-workplace/",
                "icon": "üí™",
                "label": "Using Automation to Boost Productivity in the Workplace"
              }
            ],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail/"
              }
            ],
            "credentialDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/"
              }
            ]
          },
          "categories": [
            "Communication",
            "HITL"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "HITL": [
              "Human in the Loop"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Gmail"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMTkzIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+PHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTU4LjE4MiAxOTIuMDVWOTMuMTRMMjcuNTA3IDY1LjA3NyAwIDQ5LjUwNHYxMjUuMDkxYzAgOS42NTggNy44MjUgMTcuNDU1IDE3LjQ1NSAxNy40NTV6Ii8+PHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTE5Ny44MTggMTkyLjA1aDQwLjcyN2M5LjY1OSAwIDE3LjQ1NS03LjgyNiAxNy40NTUtMTcuNDU1VjQ5LjUwNWwtMzEuMTU2IDE3LjgzNy0yNy4wMjYgMjUuNzk4eiIvPjxwYXRoIGZpbGw9IiNFQTQzMzUiIGQ9Im01OC4xODIgOTMuMTQtNC4xNzQtMzguNjQ3IDQuMTc0LTM2Ljk4OUwxMjggNjkuODY4bDY5LjgxOC01Mi4zNjQgNC42NyAzNC45OTItNC42NyA0MC42NDRMMTI4IDE0NS41MDR6Ii8+PHBhdGggZmlsbD0iI0ZCQkMwNCIgZD0iTTE5Ny44MTggMTcuNTA0VjkzLjE0TDI1NiA0OS41MDRWMjYuMjMxYzAtMjEuNTg1LTI0LjY0LTMzLjg5LTQxLjg5LTIwLjk0NXoiLz48cGF0aCBmaWxsPSIjQzUyMjFGIiBkPSJtMCA0OS41MDQgMjYuNzU5IDIwLjA3TDU4LjE4MiA5My4xNFYxNy41MDRMNDEuODkgNS4yODZDMjQuNjEtNy42NiAwIDQuNjQ2IDAgMjYuMjN6Ii8+PC9zdmc+"
      },
      "displayName": "Gmail",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 6,
          "name": "Communication"
        },
        {
          "id": 28,
          "name": "HITL"
        }
      ]
    },
    {
      "id": 565,
      "icon": "fa:sticky-note",
      "name": "n8n-nodes-base.stickyNote",
      "codex": {
        "data": {
          "alias": [
            "Comments",
            "Notes",
            "Sticky"
          ],
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"input\"]",
      "defaults": {
        "name": "Sticky Note",
        "color": "#FFD233"
      },
      "iconData": {
        "icon": "sticky-note",
        "type": "icon"
      },
      "displayName": "Sticky Note",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 834,
      "icon": "file:code.svg",
      "name": "n8n-nodes-base.code",
      "codex": {
        "data": {
          "alias": [
            "cpde",
            "Javascript",
            "JS",
            "Python",
            "Script",
            "Custom Code",
            "Function"
          ],
          "details": "The Code node allows you to execute JavaScript in your workflow.",
          "resources": {
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.code/"
              }
            ]
          },
          "categories": [
            "Development",
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers",
              "Data Transformation"
            ]
          }
        }
      },
      "group": "[\"transform\"]",
      "defaults": {
        "name": "Code"
      },
      "iconData": {
        "type": "file",
        "fileBuffer": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8xMTcxXzQ0MSkiPgo8cGF0aCBkPSJNMTcwLjI4MyA0OEgxOTYuNUMyMDMuMTI3IDQ4IDIwOC41IDQyLjYyNzQgMjA4LjUgMzZWMTJDMjA4LjUgNS4zNzI1OCAyMDMuMTI3IDAgMTk2LjUgMEgxNzAuMjgzQzEyNi4xIDAgOTAuMjgzIDM1LjgxNzIgOTAuMjgzIDgwVjE3NkM5MC4yODMgMjA2LjkyOCA2NS4yMTA5IDIzMiAzNC4yODMgMjMySDIzQzE2LjM3MjYgMjMyIDExIDIzNy4zNzIgMTEgMjQ0VjI2OEMxMSAyNzQuNjI3IDE2LjM3MjQgMjgwIDIyLjk5OTYgMjgwTDM0LjI4MyAyODBDNjUuMjEwOSAyODAgOTAuMjgzIDMwNS4wNzIgOTAuMjgzIDMzNlY0NDBDOTAuMjgzIDQ3OS43NjQgMTIyLjUxOCA1MTIgMTYyLjI4MyA1MTJIMTk2LjVDMjAzLjEyNyA1MTIgMjA4LjUgNTA2LjYyNyAyMDguNSA1MDBWNDc2QzIwOC41IDQ2OS4zNzMgMjAzLjEyNyA0NjQgMTk2LjUgNDY0SDE2Mi4yODNDMTQ5LjAyOCA0NjQgMTM4LjI4MyA0NTMuMjU1IDEzOC4yODMgNDQwVjMzNkMxMzguMjgzIDMwOS4wMjIgMTI4LjAxMSAyODQuNDQzIDExMS4xNjQgMjY1Ljk2MUMxMDYuMTA5IDI2MC40MTYgMTA2LjEwOSAyNTEuNTg0IDExMS4xNjQgMjQ2LjAzOUMxMjguMDExIDIyNy41NTcgMTM4LjI4MyAyMDIuOTc4IDEzOC4yODMgMTc2VjgwQzEzOC4yODMgNjIuMzI2OSAxNTIuNjEgNDggMTcwLjI4MyA0OFoiIGZpbGw9IiNGRjk5MjIiLz4KPHBhdGggZD0iTTMwNSAzNkMzMDUgNDIuNjI3NCAzMTAuMzczIDQ4IDMxNyA0OEgzNDIuOTc5QzM2MC42NTIgNDggMzc0Ljk3OCA2Mi4zMjY5IDM3NC45NzggODBWMTc2QzM3NC45NzggMjAyLjk3OCAzODUuMjUxIDIyNy41NTcgNDAyLjA5OCAyNDYuMDM5QzQwNy4xNTMgMjUxLjU4NCA0MDcuMTUzIDI2MC40MTYgNDAyLjA5OCAyNjUuOTYxQzM4NS4yNTEgMjg0LjQ0MyAzNzQuOTc4IDMwOS4wMjIgMzc0Ljk3OCAzMzZWNDMyQzM3NC45NzggNDQ5LjY3MyAzNjAuNjUyIDQ2NCAzNDIuOTc5IDQ2NEgzMTdDMzEwLjM3MyA0NjQgMzA1IDQ2OS4zNzMgMzA1IDQ3NlY1MDBDMzA1IDUwNi42MjcgMzEwLjM3MyA1MTIgMzE3IDUxMkgzNDIuOTc5QzM4Ny4xNjEgNTEyIDQyMi45NzggNDc2LjE4MyA0MjIuOTc4IDQzMlYzMzZDNDIyLjk3OCAzMDUuMDcyIDQ0OC4wNTEgMjgwIDQ3OC45NzkgMjgwSDQ5MEM0OTYuNjI3IDI4MCA1MDIgMjc0LjYyOCA1MDIgMjY4VjI0NEM1MDIgMjM3LjM3MyA0OTYuNjI4IDIzMiA0OTAgMjMyTDQ3OC45NzkgMjMyQzQ0OC4wNTEgMjMyIDQyMi45NzggMjA2LjkyOCA0MjIuOTc4IDE3NlY4MEM0MjIuOTc4IDM1LjgxNzIgMzg3LjE2MSAwIDM0Mi45NzkgMEgzMTdDMzEwLjM3MyAwIDMwNSA1LjM3MjU4IDMwNSAxMlYzNloiIGZpbGw9IiNGRjk5MjIiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xMTcxXzQ0MSI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo="
      },
      "displayName": "Code",
      "typeVersion": 2,
      "nodeCategories": [
        {
          "id": 5,
          "name": "Development"
        },
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    }
  ],
  "views": 30,
  "recentViews": 2,
  "workflow": {
    "id": "sbTxG7FVDyFq0sLR",
    "meta": {
      "instanceId": "{{INSTANCE_ID}}",
      "templateCredsSetupCompleted": true
    },
    "name": "GSheets CRM",
    "tags": [],
    "nodes": [
      {
        "id": "c0760f3c-0feb-43bb-9b52-cc9307e0b98f",
        "name": "Webhook: Lead Stage Changed",
        "type": "n8n-nodes-base.webhook",
        "notes": "Receives JSON when a lead's Stage (Leads!E) changes.\nExpected body keys:\n- name (Leads!A)\n- email (Leads!C)\n- source_id (for mapping 1=Instagram,2=Facebook) OR source_text\n- stage (new stage text)\n- previous_stage (optional)",
        "position": [
          -896,
          -80
        ],
        "webhookId": "{{WEBHOOK_ID_LEAD_STAGE_CHANGED}}",
        "parameters": {
          "path": "lead-stage-changed",
          "options": {
            "responseData": "OK"
          },
          "httpMethod": "POST"
        },
        "typeVersion": 1
      },
      {
        "id": "a91971ec-9414-4d0d-98d9-273761071c30",
        "name": "Prepare Email Fields",
        "type": "n8n-nodes-base.set",
        "notes": "Derives firstName and sourcePlatform for the email body.",
        "position": [
          -672,
          -80
        ],
        "parameters": {
          "fields": {
            "values": [
              {
                "name": "firstName",
                "stringValue": "=={{ $json.body.name ? $json.body.name.trim().split(' ')[0] : 'there' }}"
              },
              {
                "name": "sourcePlatform ",
                "stringValue": "={{ $json.body.source_text || 'Unknown' }}"
              },
              {
                "name": "stage",
                "stringValue": "={{ $json.body.stage }}"
              },
              {
                "name": "previousStage",
                "stringValue": "={{ $json.body.previous_stage || '' }}"
              }
            ]
          },
          "options": {
            "includeBinary": false
          }
        },
        "typeVersion": 3
      },
      {
        "id": "00ef748d-22e8-4436-a0e7-7ef1ed9017fe",
        "name": "Gmail: Send Stage-Change Email",
        "type": "n8n-nodes-base.gmail",
        "notes": "Sends the templated email on any Stage change.",
        "position": [
          -224,
          -176
        ],
        "webhookId": "{{GMAIL_NODE_WEBHOOK_ID_STAGE_CHANGE}}",
        "parameters": {
          "sendTo": "={{ $('Prepare Email Fields').item.json.body.email }}",
          "message": "=Hi {{ $('Prepare Email Fields').item.json.body.name }},<br><br>Thanks for the call earlier & happy I was able to meet you. Just letting you know that I'll work on a proposal immediately and have something over to you in the next 2-3 hours.<br><br>Stay tuned & let me know if you have any questions.<br><br>Thanks,<br>{{SENDER_NAME}}",
          "options": {},
          "subject": "Next Steps"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "{{GMAIL_CREDENTIAL_ID}}",
            "name": "{{GMAIL_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "baa49e6a-3c2e-4c42-ae96-9b2f0e5a0db3",
        "name": "IF: Stage == Won",
        "type": "n8n-nodes-base.if",
        "notes": "Branch for when the lead has been marked Won.",
        "position": [
          -224,
          16
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "5feb2d51-b3ba-4b5e-9064-4735e10d5a38",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.stage }}",
                "rightValue": "Won"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "855b796a-8588-4f43-8b39-48406c37c67d",
        "name": "Format Start Timestamp",
        "type": "n8n-nodes-base.dateTime",
        "notes": "Produces Start Date & Time as: dd/mm/yyyy at HH:MM",
        "position": [
          0,
          16
        ],
        "parameters": {
          "value": "={{ $now }}",
          "custom": true,
          "options": {},
          "toFormat": "DD/MM/YYYY 'at' HH:mm"
        },
        "typeVersion": 1
      },
      {
        "id": "25f0b4f3-0305-4ce6-83f8-e37fc90d51ca",
        "name": "GS: Clients Append (On Won)",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "Appends the new client with Project Status=In Progress and Start Date & Time.",
        "position": [
          224,
          16
        ],
        "parameters": {
          "columns": {
            "value": {
              "Name": "={{ $json.body.name }}",
              "Client Email": "={{ $json.body.email }}",
              "Start Date & Time": "={{ $json.data }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Client Type",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Client Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Client Email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Client Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Project Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Project Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Tenure",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Tenure",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Start Date & Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Start Date & Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "End Date & Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "End Date & Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Time to Deliver",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Time to Deliver",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "useAppend": true,
            "cellFormat": "USER_ENTERED"
          },
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "{{CLIENTS_GID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit#gid={{CLIENTS_GID}}",
            "cachedResultName": "Clients"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "{{GOOGLE_SHEETS_DOC_ID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit",
            "cachedResultName": "{{SHEET_NAME}}"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "{{GSHEETS_CREDENTIAL_ID}}",
            "name": "{{GSHEETS_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "100c9018-23b7-4724-93ef-373566ae9c42",
        "name": "Webhook: Lead Qualified?",
        "type": "n8n-nodes-base.webhook",
        "notes": "Receives JSON when Leads!H (Qualified?) is checked.\nExpected body keys:\n- name (A)\n- email (C)\n- qualified (boolean or 'TRUE'/1)",
        "position": [
          -896,
          -624
        ],
        "webhookId": "{{WEBHOOK_ID_LEAD_QUALIFIED}}",
        "parameters": {
          "path": "lead-qualified",
          "options": {
            "responseData": "OK"
          },
          "httpMethod": "POST"
        },
        "typeVersion": 1
      },
      {
        "id": "e5fe57ce-c457-4f03-9c96-7ac385b2a42f",
        "name": "IF: Is Qualified",
        "type": "n8n-nodes-base.if",
        "position": [
          -672,
          -624
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "285b4bc9-5a4b-4f6b-bd55-eb54d6a6fcc1",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.body.qualified }}",
                "rightValue": "=\"true\""
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "04851d87-b2c6-4383-9687-382f3bee1e7b",
        "name": "Gmail: Send Cal.com Invite",
        "type": "n8n-nodes-base.gmail",
        "notes": "Sends the booking link when Qualified? is checked.",
        "position": [
          -448,
          -624
        ],
        "webhookId": "{{GMAIL_NODE_WEBHOOK_ID_CAL_INVITE}}",
        "parameters": {
          "sendTo": "={{ $json.body.email }}",
          "message": "=Hi {{$json.body.name ? $json.body.name.split(' ')[0] : 'there'}},<br><br>Congrats ‚Äî you‚Äôre qualified and we are super excited to know more from you! Please book your discovery call here: <a href=\"{{CAL_COM_BOOKING_URL}}\" target=\"_blank\">Schedule on Cal.com</a>.<br><br>Thanks,<br>{{SENDER_NAME}}",
          "options": {},
          "subject": "Book Your Discovery Call"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "{{GMAIL_CREDENTIAL_ID}}",
            "name": "{{GMAIL_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "99f6f896-ac20-454b-a480-88a71aabe0b0",
        "name": "GS: Leads Update Stage to Meeting Booked",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "Uses Email (Column C) as key to update Stage (E) to 'Meeting Booked'.",
        "position": [
          -672,
          -368
        ],
        "parameters": {
          "columns": {
            "value": {
              "Stage": "Meeting Booked",
              "Client Email": "={{ $json.body.payload.attendees[0].email }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date Updated",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date Updated",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Client Email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Client Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Lead Source",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Lead Source",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Stage",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Stage",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Asignee",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Asignee",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Discovery Call URL",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Discovery Call URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Qualitfied?",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Qualitfied?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Client Email"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "cellFormat": "USER_ENTERED"
          },
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid={{LEADS_GID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit#gid={{LEADS_GID}}",
            "cachedResultName": "Leads"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "{{GOOGLE_SHEETS_DOC_ID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit",
            "cachedResultName": "{{SHEET_NAME}}"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "{{GSHEETS_CREDENTIAL_ID}}",
            "name": "{{GSHEETS_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "b2acf148-b6bc-49d3-8e76-fe890459c1dc",
        "name": "Webhook: Client Status Changed",
        "type": "n8n-nodes-base.webhook",
        "notes": "Receives JSON when Clients!D (Project Status) changes.\nExpected body keys:\n- email (Clients!C)\n- project_status (Clients!D new value)",
        "position": [
          -880,
          304
        ],
        "webhookId": "{{WEBHOOK_ID_CLIENT_STATUS_CHANGED}}",
        "parameters": {
          "path": "client-status-changed",
          "options": {
            "responseData": "OK"
          },
          "httpMethod": "POST"
        },
        "typeVersion": 1
      },
      {
        "id": "01223e18-22c3-4622-ba66-0425aad4bcd6",
        "name": "IF: Delivered?",
        "type": "n8n-nodes-base.if",
        "position": [
          -656,
          304
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "8be5b372-0114-4595-ab9a-d7903d63a716",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.body.project_status }}",
                "rightValue": "Delivered"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "438ffb35-490f-49d1-9031-c32447b59992",
        "name": "GS: Clients Lookup by Email",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "Fetches the row to read Start Date & Time (F) for duration calc.",
        "position": [
          -432,
          304
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "={{ $json.body.email }}",
                "lookupColumn": "Client Email"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "{{CLIENTS_GID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit#gid={{CLIENTS_GID}}",
            "cachedResultName": "Clients"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "{{GOOGLE_SHEETS_DOC_ID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit",
            "cachedResultName": "{{SHEET_NAME}}"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "{{GSHEETS_CREDENTIAL_ID}}",
            "name": "{{GSHEETS_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "1579d825-5a67-4e52-b7d5-f4dc493cf790",
        "name": "Format End Timestamp",
        "type": "n8n-nodes-base.dateTime",
        "notes": "End Date & Time formatted as dd/mm/yyyy at HH:MM",
        "position": [
          -208,
          304
        ],
        "parameters": {
          "value": "={{ $now }}",
          "custom": true,
          "options": {},
          "toFormat": "DD/MM/YYYY 'at' HH:mm"
        },
        "typeVersion": 1
      },
      {
        "id": "1aec66f5-ce82-4375-9202-a3ba2a5ad118",
        "name": "GS: Clients Update End & Duration",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "Sets End Date & Time (G) and Time To Deliver (H).",
        "position": [
          240,
          304
        ],
        "parameters": {
          "columns": {
            "value": {
              "Client Email": "={{ $json[\"Client Email\"] }}",
              "End Date & Time": "={{ $json.endStr }}",
              "Time to Deliver": "={{ $json.duration }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Client Type",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Client Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Client Email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Client Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Project Status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Project Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Tenure",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Tenure",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Start Date & Time",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Start Date & Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "End Date & Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "End Date & Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Time to Deliver",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Time to Deliver",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Client Email"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "cellFormat": "USER_ENTERED"
          },
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "{{CLIENTS_GID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit#gid={{CLIENTS_GID}}",
            "cachedResultName": "Clients"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "{{GOOGLE_SHEETS_DOC_ID}}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{{GOOGLE_SHEETS_DOC_ID}}/edit",
            "cachedResultName": "{{SHEET_NAME}}"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "{{GSHEETS_CREDENTIAL_ID}}",
            "name": "{{GSHEETS_CREDENTIAL_NAME}}"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "1f2a3e16-70c7-402f-ace7-782f9de34fd3",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          16,
          304
        ],
        "parameters": {
          "jsCode": "// Compute delivery duration from \"Start Date & Time\" (F) and formatted \"End\" from previous node\n// Expects this node to run AFTER \"Format End Timestamp\" and AFTER the Clients row lookup\n\nconst items = $input.all();\n\n// Helper: parse \"dd/mm/yyyy at HH:MM\"\nfunction parseDT(s) {\n  if (!s) return null;\n  const m = String(s).match(/(\\d{2})\\/(\\d{2})\\/(\\d{4}).*?(\\d{2}):(\\d{2})/);\n  if (!m) return null;\n  const [, d, M, y, h, min] = m;\n  return new Date(Number(y), Number(M) - 1, Number(d), Number(h), Number(min), 0);\n}\n\n// Get the formatted end timestamp from the Date & Time node\nconst endStrFromNode = $node[\"Format End Timestamp\"]?.json?.data || \"\";\n\nfor (const item of items) {\n  const row = item.json || {};\n\n  // Try several keys for Start column F (depending on how Google Sheets node labeled it)\n  const startStr =\n    row[\"Start Date & Time\"] ??\n    row[\"F\"] ??\n    row[\"Start\"] ??\n    \"\";\n\n  // Prefer the value from Date & Time node; fall back to any end value already present\n  const endStr = endStrFromNode || row[\"End Date & Time\"] || \"\";\n\n  const start = parseDT(startStr);\n  const end = parseDT(endStr);\n\n  let duration = \"N/A\";\n  if (start && end) {\n    const ms = end - start;\n    const days = Math.floor(ms / 86_400_000);\n    const hrs = Math.floor((ms % 86_400_000) / 3_600_000);\n    const mins = Math.floor((ms % 3_600_000) / 60_000);\n    duration = `${days}d ${hrs}h ${mins}m`;\n  }\n\n  // Attach results to the item\n  item.json.endStr = endStr;\n  item.json.duration = duration;\n}\n\nreturn items;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "12c036dc-4e13-4bfd-95d2-48da0e8337b6",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          -448,
          -80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "37fbb2ef-5861-4fc8-ab06-71fe4364be63",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.stage }}",
                "rightValue": "Awaiting Proposal"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "ec815439-bfb1-4edb-8a70-9db1c167a868",
        "name": "Webhook: Meeting Booked",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -896,
          -368
        ],
        "webhookId": "{{WEBHOOK_ID_MEETING_BOOKED}}",
        "parameters": {
          "path": "cal-booked",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 2.1
      },
      {
        "id": "26784981-b9f6-44ca-8329-62072dd4fd0f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1232,
          -848
        ],
        "parameters": {
          "width": 1968,
          "height": 1408,
          "content": "# Google Sheets Automated CRM"
        },
        "typeVersion": 1
      },
      {
        "id": "815c2626-dd90-4976-92d7-ce93bad40e1e",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2080,
          -848
        ],
        "parameters": {
          "color": 6,
          "width": 816,
          "height": 4128,
          "content": "# The App Script Needed (Use this for your Google Worksheet App Script)\n\n/**\n * ScaleFlow CRM ‚Äî Google Apps Script bridge to n8n\n * Spreadsheet: \"ScaleFlow CRM\"\n * Tabs: \"Leads\", \"Clients\"\n *\n * WHAT IT DOES\n * - When a Lead‚Äôs Stage (Leads!E) changes ‚Üí POST to n8n /lead-stage-changed\n * - When Qualified? checkbox (Leads!H) is edited ‚Üí POST to n8n /lead-qualified\n * - When a Client‚Äôs Project Status (Clients!D) changes ‚Üí POST to n8n /client-status-changed\n *\n * STEPS\n * 1) Paste this into Extensions ‚Üí Apps Script.\n * 2) Replace the WEBHOOK URLs below with your n8n endpoints.\n * 3) Save. First edit will prompt for authorization. (Optional) Run createInstallableTrigger() once.\n */\n\nconst WEBHOOKS = {\n  STAGE_CHANGED: 'https://{{YOUR_N8N_DOMAIN}}/webhook/lead-stage-changed',\n  LEAD_QUALIFIED: 'https://{{YOUR_N8N_DOMAIN}}/webhook/lead-qualified',\n  CLIENT_STATUS_CHANGED: 'https://{{YOUR_N8N_DOMAIN}}/webhook/client-status-changed',\n};\n\nconst TABS = {\n  LEADS: 'Leads',\n  CLIENTS: 'Clients',\n};\n\n// Column indexes (1-based)\nconst COL = {\n  NAME: 1,          // Leads!A\n  CLIENT_TYPE: 2,   // Clients!B\n  EMAIL: 3,         // Leads/Clients!C\n  LEAD_SOURCE: 4,   // Leads!D\n  LEAD_STAGE: 5,    // Leads!E\n  LEAD_ASSIGNEE: 6, // Leads!F\n  PROJECT_STATUS: 4,// Clients!D\n  QUALIFIED: 8,     // Leads!H (checkbox)\n};\n\n/**\n * MAIN: fires on any cell edit\n */\nfunction onEdit(e) {\n  try {\n    if (!e || !e.range) return;\n    // Only process single-cell edits\n    if (e.range.getNumRows() !== 1 || e.range.getNumColumns() !== 1) return;\n\n    const sheet = e.range.getSheet();\n    const tabName = sheet.getName();\n    const row = e.range.getRow();\n    const col = e.range.getColumn();\n\n    // Skip header row\n    if (row === 1) return;\n\n    if (tabName === TABS.LEADS) {\n      handleLeadsEdit_(sheet, row, col, e);\n    } else if (tabName === TABS.CLIENTS) {\n      handleClientsEdit_(sheet, row, col, e);\n    }\n  } catch (err) {\n    console.error('onEdit error:', err);\n  }\n}\n\n/**\n * Handle edits on Leads tab\n */\nfunction handleLeadsEdit_(sheet, row, col, e) {\n  // Read row A..H (adjust width if you have more columns)\n  const values = sheet.getRange(row, 1, 1, 8).getValues()[0];\n  const name = asString_(values[COL.NAME - 1]);\n  const email = asString_(values[COL.EMAIL - 1]);\n  const sourceText = asString_(values[COL.LEAD_SOURCE - 1]);\n  const stageText = asString_(values[COL.LEAD_STAGE - 1]);\n  const qualifiedVal = values[COL.QUALIFIED - 1];\n\n  // 1) Stage changed (Leads!E)\n  if (col === COL.LEAD_STAGE) {\n    const payload = {\n      name,\n      email,\n      source_text: sourceText || '',\n      stage: stageText || '',\n      previous_stage: e.oldValue || '',\n      row: row,\n      tab: TABS.LEADS,\n    };\n    postJson_(WEBHOOKS.STAGE_CHANGED, payload);\n  }\n\n  // 2) Qualified? checkbox edited (Leads!H)\n  if (col === COL.QUALIFIED) {\n    const payload = {\n      name,\n      email,\n      qualified: isChecked_(qualifiedVal),\n      row: row,\n      tab: TABS.LEADS,\n    };\n    postJson_(WEBHOOKS.LEAD_QUALIFIED, payload);\n  }\n}\n\n/**\n * Handle edits on Clients tab\n */\nfunction handleClientsEdit_(sheet, row, col, e) {\n  // Read row A..H (adjust width if you have more columns)\n  const values = sheet.getRange(row, 1, 1, 8).getValues()[0];\n  const email = asString_(values[COL.EMAIL - 1]);\n  const projectStatus = asString_(values[COL.PROJECT_STATUS - 1]);\n\n  // 3) Project Status changed (Clients!D)\n  if (col === COL.PROJECT_STATUS) {\n    const payload = {\n      email,\n      project_status: projectStatus || '',\n      previous_status: e.oldValue || '',\n      row: row,\n      tab: TABS.CLIENTS,\n    };\n    postJson_(WEBHOOKS.CLIENT_STATUS_CHANGED, payload);\n  }\n}\n\n/**\n * POST JSON helper\n */\nfunction postJson_(url, obj) {\n  if (!url || url.indexOf('{{YOUR_N8N_DOMAIN}}') !== -1) {\n    console.warn('Webhook URL not set. Skipping POST:', url, obj);\n    return;\n  }\n  try {\n    const res = UrlFetchApp.fetch(url, {\n      method: 'post',\n      contentType: 'application/json',\n      payload: JSON.stringify(obj),\n      muteHttpExceptions: true,\n    });\n    // Optional: log for debugging\n    console.log('POST', url, res.getResponseCode(), safeTrunc_(res.getContentText(), 500));\n  } catch (err) {\n    console.error('postJson_ error:', url, err && err.message);\n  }\n}\n\n/**\n * UTILITIES\n */\nfunction isChecked_(val) {\n  // Accepts true/false, \"TRUE\"/\"FALSE\", 1/0\n  if (val === true) return true;\n  if (val === false) return false;\n  const s = String(val).trim().toUpperCase();\n  return s === 'TRUE' || s === '1' || s === 'CHECKED' || s === 'YES';\n}\n\nfunction asString_(v) {\n  return v == null ? '' : String(v);\n}\n\nfunction safeTrunc_(s, n) {\n  if (!s) return '';\n  return s.length > n ? s.slice(0, n) + '‚Ä¶' : s;\n}\n\n/**\n * OPTIONAL: create an installable onEdit trigger (runs with full auth scope)\n * Run this once if you want to avoid simple-trigger limitations.\n */\nfunction createInstallableTrigger() {\n  const ss = SpreadsheetApp.getActive();\n  // Clear existing triggers for safety\n  ScriptApp.getProjectTriggers().forEach(t => {\n    if (t.getHandlerFunction && t.getHandlerFunction() === 'onEdit') {\n      ScriptApp.deleteTrigger(t);\n    }\n  });\n  ScriptApp.newTrigger('onEdit').forSpreadsheet(ss).onEdit().create();\n}\n\n/**\n * OPTIONAL: quick test (does not fire onEdit)\n * Replace payloads and run from editor to verify webhooks.\n */\nfunction testPing_() {\n  postJson_(WEBHOOKS.STAGE_CHANGED, {\n    name: 'Test User',\n    email: 'test@example.com',\n    source_text: 'Instagram',\n    stage: 'Proposal',\n    previous_stage: 'Screening',\n    row: 2,\n    tab: TABS.LEADS,\n  });\n\n  postJson_(WEBHOOKS.LEAD_QUALIFIED, {\n    name: 'Test User',\n    email: 'test@example.com',\n    qualified: true,\n    row: 2,\n    tab: TABS.LEADS,\n  });\n\n  postJson_(WEBHOOKS.CLIENT_STATUS_CHANGED, {\n    email: 'client@example.com',\n    project_status: 'Delivered',\n    previous_status: 'In Progress',\n    row: 3,\n    tab: TABS.CLIENTS,\n  });\n}\n"
        },
        "typeVersion": 1
      },
      {
        "id": "7b60fbcd-c39a-4313-967a-e7b8310286c1",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -944,
          -688
        ],
        "parameters": {
          "color": 4,
          "width": 848,
          "height": 240,
          "content": "# Lead Qualification"
        },
        "typeVersion": 1
      },
      {
        "id": "bff994fa-80d2-4ccd-8964-72fc8a694cc3",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -944,
          -448
        ],
        "parameters": {
          "color": 4,
          "width": 848,
          "height": 256,
          "content": "# Changing Stage to Meeting Booked\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ea32e27d-3fc6-4bed-a61d-57ec7aa24fc0",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -944,
          -192
        ],
        "parameters": {
          "color": 4,
          "width": 1440,
          "height": 384,
          "content": "# Proposal Follow-Up / Client Won Flow\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5eb61a5b-b07c-42a7-9ff4-d178985e04b2",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -944,
          192
        ],
        "parameters": {
          "color": 4,
          "width": 1440,
          "height": 304,
          "content": "# Project Fulfillment Duration\n"
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "callerPolicy": "workflowsFromSameOwner",
      "errorWorkflow": "{{ERROR_WORKFLOW_ID}}",
      "executionOrder": "v1"
    },
    "versionId": "fbf5f5f3-e31e-4f4d-a480-f8c382bdfe04",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Gmail: Send Stage-Change Email",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "IF: Stage == Won",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "GS: Clients Update End & Duration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Delivered?": {
        "main": [
          [
            {
              "node": "GS: Clients Lookup by Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Is Qualified": {
        "main": [
          [
            {
              "node": "Gmail: Send Cal.com Invite",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Stage == Won": {
        "main": [
          [
            {
              "node": "Format Start Timestamp",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Format End Timestamp": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Email Fields": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Start Timestamp": {
        "main": [
          [
            {
              "node": "GS: Clients Append (On Won)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook: Meeting Booked": {
        "main": [
          [
            {
              "node": "GS: Leads Update Stage to Meeting Booked",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook: Lead Qualified?": {
        "main": [
          [
            {
              "node": "IF: Is Qualified",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GS: Clients Lookup by Email": {
        "main": [
          [
            {
              "node": "Format End Timestamp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook: Lead Stage Changed": {
        "main": [
          [
            {
              "node": "Prepare Email Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook: Client Status Changed": {
        "main": [
          [
            {
              "node": "IF: Delivered?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  "lastUpdatedBy": 29,
  "workflowInfo": {
    "nodeCount": 24,
    "nodeTypes": {
      "n8n-nodes-base.if": {
        "count": 4
      },
      "n8n-nodes-base.set": {
        "count": 1
      },
      "n8n-nodes-base.code": {
        "count": 1
      },
      "n8n-nodes-base.gmail": {
        "count": 2
      },
      "n8n-nodes-base.webhook": {
        "count": 4
      },
      "n8n-nodes-base.dateTime": {
        "count": 2
      },
      "n8n-nodes-base.stickyNote": {
        "count": 6
      },
      "n8n-nodes-base.googleSheets": {
        "count": 4
      }
    }
  },
  "categories": [
    {
      "id": 39,
      "name": "CRM"
    },
    {
      "id": 51,
      "name": "Multimodal AI"
    }
  ],
  "image": []
}