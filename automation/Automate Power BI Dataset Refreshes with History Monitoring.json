{
  "id": 7336,
  "name": "Automate Power BI Dataset Refreshes with History Monitoring",
  "totalViews": 258,
  "purchaseUrl": null,
  "user": {
    "name": "Robert Breen",
    "username": "rbreen",
    "bio": "Professional services consultant with over 10 years of experience solving complex business problems across industries. I specialize in n8n and process automation‚Äîdesigning custom workflows that integrate tools like Google Calendar, Airtable, GPT, and internal systems. Whether you need to automate scheduling, sync data, or streamline operations, I build solutions that save time and drive results.",
    "verified": true,
    "links": [
      "https://ynteractive.com/"
    ],
    "avatar": "https://gravatar.com/avatar/15bb5ad97bad47ca2079e1fa123a8287000c72c86498c90043f70ec2adab05f3?r=pg&d=retro&size=200"
  },
  "description": "*This workflow contains community nodes that are only compatible with the self-hosted version of n8n.*\n\nThis n8n workflow provides automated Power BI dataset refresh capabilities with built-in refresh history monitoring. It triggers a dataset refresh in Power BI and simultaneously checks the refresh history to track data update status. This is perfect for data analysts, business intelligence teams, or anyone who needs to automate Power BI dataset refreshes and monitor their success rates without manual intervention.\n\n### Key Features:\n- Automated Power BI dataset refresh triggering\n- Simultaneous refresh history monitoring\n- Manual trigger for on-demand execution\n- Real-time status tracking\n- Integration with Power BI REST API\n- Support for workspace and personal datasets\n\n## Step-by-Step Implementation Guide\n\n### Prerequisites\nBefore setting up this workflow, you'll need:\n\n1. **n8n instance** (cloud or self-hosted)\n2. **Power BI account** (Pro or Premium)\n3. **Microsoft Azure App Registration** for API access\n4. **Power BI dataset** that you want to refresh\n\n### Step 1: Set Up Azure App Registration\n\n1. Go to [Azure Portal](https://portal.azure.com/)\n2. Navigate to **Azure Active Directory** ‚Üí **App registrations**\n3. Click **New registration**\n4. Configure your app:\n   - **Name**: `n8n-powerbi-integration`\n   - **Supported account types**: Accounts in this organizational directory only\n   - **Redirect URI**: `https://your-n8n-instance.com/rest/oauth2-credential/callback`\n5. Click **Register**\n6. Note down the **Application (client) ID** and **Directory (tenant) ID**\n\n### Step 2: Configure App Permissions\n\n1. In your app registration, go to **API permissions**\n2. Click **Add a permission** ‚Üí **Power BI Service**\n3. Select **Delegated permissions** and add:\n   - `Dataset.ReadWrite.All`\n   - `Dataset.Read.All`\n   - `Workspace.Read.All`\n4. Click **Grant admin consent** for your organization\n\n### Step 3: Create Client Secret\n\n1. In your app registration, go to **Certificates & secrets**\n2. Click **New client secret**\n3. Add description: `n8n-powerbi-secret`\n4. Set expiration (recommended: 24 months)\n5. Click **Add** and copy the secret value immediately\n\n### Step 4: Configure Power BI API Credentials in n8n\n\n1. In n8n, go to **Credentials** ‚Üí **Add Credential** ‚Üí **Power BI OAuth2 API**\n2. Configure as follows:\n   - **Client ID**: Your Application (client) ID from Step 1\n   - **Client Secret**: Your client secret from Step 3\n   - **Scope**: `https://analysis.windows.net/powerbi/api/.default`\n3. Save and test the connection\n\n\n\n### Step 6: Import and Configure the Workflow\n\n1. Copy the provided workflow JSON\n2. In n8n, click **Import from File** or **Import from Clipboard**\n3. Paste the workflow JSON\n4. Configure each node as detailed below:\n\n#### Node Configuration Details:\n\n##### When clicking 'Execute workflow' (Manual Trigger)\n- **Type**: Manual Trigger\n- **Purpose**: Allows manual execution of the workflow\n- No configuration needed\n\n##### Refresh Datasource (Power BI)\n- **Resource**: `dataset`\n- **Operation**: `refresh`\n- **Group ID**: `me` (for personal workspace) or your workspace ID\n- **Dataset ID**: Your Power BI dataset ID (from Step 5)\n- **Credentials**: Select your \"Power BI account\"\n\n##### Check Refresh History (Power BI)\n- **Resource**: `dataset`\n- **Operation**: `getRefreshHistory`\n- **Group ID**: `me` (for personal workspace) or your workspace ID  \n- **Dataset ID**: Your Power BI dataset ID (same as above)\n- **Top**: `10` (number of recent refresh records to retrieve)\n- **Credentials**: Select your \"Power BI account\"\n\n\n\n## Workflow Flow Summary\n\n1. **Manual Trigger** ‚Üí User initiates workflow execution\n2. **Parallel Execution**:\n   - **Refresh Dataset** ‚Üí Triggers Power BI dataset refresh\n   - **Get History** ‚Üí Retrieves recent refresh history\n3. **Results** ‚Üí Both operations complete simultaneously providing:\n   - Confirmation of refresh initiation\n   - Historical context of previous refreshes\n\n\n\n## Contact Information\n\n**Robert A Ynteractive**\n\nFor support, customization, or questions about this workflow:\n\n- üìß Email: rbreen@ynteractive.com\n- üåê Website: https://ynteractive.com/\n- üíº LinkedIn: https://www.linkedin.com/in/robert-breen-29429625/\n\n*Need help implementing this workflow or want custom automation solutions? Get in touch for professional n8n consulting and workflow development services.*",
  "createdAt": "2025-08-13T18:00:28.951Z",
  "nodes": [
    {
      "id": 565,
      "icon": "fa:sticky-note",
      "name": "n8n-nodes-base.stickyNote",
      "codex": {
        "data": {
          "alias": [
            "Comments",
            "Notes",
            "Sticky"
          ],
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0",
          "subcategories": {
            "Core Nodes": [
              "Helpers"
            ]
          }
        }
      },
      "group": "[\"input\"]",
      "defaults": {
        "name": "Sticky Note",
        "color": "#FFD233"
      },
      "iconData": {
        "icon": "sticky-note",
        "type": "icon"
      },
      "displayName": "Sticky Note",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    },
    {
      "id": 838,
      "icon": "fa:mouse-pointer",
      "name": "n8n-nodes-base.manualTrigger",
      "codex": {
        "data": {
          "resources": {
            "generic": [],
            "primaryDocumentation": [
              {
                "url": "https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.manualworkflowtrigger/"
              }
            ]
          },
          "categories": [
            "Core Nodes"
          ],
          "nodeVersion": "1.0",
          "codexVersion": "1.0"
        }
      },
      "group": "[\"trigger\"]",
      "defaults": {
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "color": "#909298"
      },
      "iconData": {
        "icon": "mouse-pointer",
        "type": "icon"
      },
      "displayName": "Manual Trigger",
      "typeVersion": 1,
      "nodeCategories": [
        {
          "id": 9,
          "name": "Core Nodes"
        }
      ]
    }
  ],
  "views": 258,
  "recentViews": 8,
  "workflow": {
    "meta": {
      "instanceId": "efb474b59b0341d7791932605bd9ff04a6c7ed9941fdd53dc4a2e4b99a6f9439",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "be660458-e667-4bad-84c6-b43635acb074",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -520,
          -200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "34b3425b-e8ce-4713-a786-417b898e3b89",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1460,
          -1000
        ],
        "parameters": {
          "color": 5,
          "width": 832,
          "height": 1360,
          "content": "## üì¨ Need Help or Want to Customize This?\nüìß [robert@ynteractive.com](mailto:robert@ynteractive.com)  \nüîó [LinkedIn](https://www.linkedin.com/in/robert-breen-29429625/)\n\n\n\n### Step 1: Set Up Azure App Registration\n\n1. Go to [Azure Portal](https://portal.azure.com/)\n2. Navigate to **Azure Active Directory** ‚Üí **App registrations**\n3. Click **New registration**\n4. Configure your app:\n   - **Name**: `n8n-powerbi-integration`\n   - **Supported account types**: Accounts in this organizational directory only\n   - **Redirect URI**: `https://your-n8n-instance.com/rest/oauth2-credential/callback`\n5. Click **Register**\n6. Note down the **Application (client) ID** and **Directory (tenant) ID**\n\n### Step 2: Configure App Permissions\n\n1. In your app registration, go to **API permissions**\n2. Click **Add a permission** ‚Üí **Power BI Service**\n3. Select **Delegated permissions** and add:\n   - `Dataset.ReadWrite.All`\n   - `Dataset.Read.All`\n   - `Workspace.Read.All`\n4. Click **Grant admin consent** for your organization\n\n### Step 3: Create Client Secret\n\n1. In your app registration, go to **Certificates & secrets**\n2. Click **New client secret**\n3. Add description: `n8n-powerbi-secret`\n4. Set expiration (recommended: 24 months)\n5. Click **Add** and copy the secret value immediately\n\n### Step 4: Configure Power BI API Credentials in n8n\n\n1. In n8n, go to **Credentials** ‚Üí **Add Credential** ‚Üí **Power BI OAuth2 API**\n2. Configure as follows:\n   - **Client ID**: Your Application (client) ID from Step 1\n   - **Client Secret**: Your client secret from Step 3\n   - **Scope**: `https://analysis.windows.net/powerbi/api/.default`\n3. Save and test the connection\n"
        },
        "typeVersion": 1
      },
      {
        "id": "921821cb-ca64-49c9-87d6-083395532c72",
        "name": "Refresh Datasource",
        "type": "n8n-nodes-powerbi.powerBi",
        "position": [
          -180,
          -360
        ],
        "parameters": {
          "groupId": "me",
          "resource": "dataset",
          "datasetId": "475347ba-f8d9-4f9d-b5c7-87fa6d5afd4c",
          "operation": "refresh"
        },
        "credentials": {
          "powerBiApiOAuth2Api": {
            "id": "fEMWdLtLYSmHmvlb",
            "name": "Power BI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "53dccada-90a0-4408-aaab-395366109010",
        "name": "Check Refresh History",
        "type": "n8n-nodes-powerbi.powerBi",
        "position": [
          -180,
          -20
        ],
        "parameters": {
          "top": 10,
          "groupId": "me",
          "resource": "dataset",
          "datasetId": "475347ba-f8d9-4f9d-b5c7-87fa6d5afd4c",
          "operation": "getRefreshHistory"
        },
        "credentials": {
          "powerBiApiOAuth2Api": {
            "id": "fEMWdLtLYSmHmvlb",
            "name": "Power BI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "79ad7fb7-eadb-491d-80bc-6626facd7d3d",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -600,
          -1000
        ],
        "parameters": {
          "color": 4,
          "width": 712,
          "height": 1360,
          "content": "\n#### Node Configuration Details:\n\n##### When clicking 'Execute workflow' (Manual Trigger)\n- **Type**: Manual Trigger\n- **Purpose**: Allows manual execution of the workflow\n- No configuration needed\n\n##### Refresh Datasource (Power BI)\n- **Resource**: `dataset`\n- **Operation**: `refresh`\n- **Group ID**: `me` (for personal workspace) or your workspace ID\n- **Dataset ID**: Your Power BI dataset ID (from Step 5)\n- **Credentials**: Select your \"Power BI account\"\n\n##### Check Refresh History (Power BI)\n- **Resource**: `dataset`\n- **Operation**: `getRefreshHistory`\n- **Group ID**: `me` (for personal workspace) or your workspace ID  \n- **Dataset ID**: Your Power BI dataset ID (same as above)\n- **Top**: `10` (number of recent refresh records to retrieve)\n- **Credentials**: Select your \"Power BI account\"\n\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Refresh Datasource",
              "type": "main",
              "index": 0
            },
            {
              "node": "Check Refresh History",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  "lastUpdatedBy": 62,
  "workflowInfo": {
    "nodeCount": 5,
    "nodeTypes": {
      "n8n-nodes-base.stickyNote": {
        "count": 2
      },
      "n8n-nodes-powerbi.powerBi": {
        "count": 2
      },
      "n8n-nodes-base.manualTrigger": {
        "count": 1
      }
    }
  },
  "categories": [
    {
      "id": 5,
      "name": "Engineering"
    },
    {
      "id": 51,
      "name": "Multimodal AI"
    }
  ],
  "image": []
}